<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>FSLogix on Patrick&#39;s Multi-Cloud Blog</title>
        <link>http://localhost:1313/categories/fslogix/</link>
        <description>Recent content in FSLogix on Patrick&#39;s Multi-Cloud Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <copyright>Patrick Köhler</copyright>
        <lastBuildDate>Thu, 29 Jul 2021 16:56:47 +0600</lastBuildDate><atom:link href="http://localhost:1313/categories/fslogix/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Start VM on Connect for Pooled and Personal Host Pools in WVD</title>
        <link>http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/</link>
        <pubDate>Thu, 29 Jul 2021 16:56:47 +0600</pubDate>
        
        <guid>http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/</guid>
        <description>&lt;img src="http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/title.png" alt="Featured image of post Start VM on Connect for Pooled and Personal Host Pools in WVD" /&gt;&lt;p&gt;This announcement of Eva Seydl, Program Manager at Microsoft, made my week! Start VM on Connect, a feature well known to most of the WVD rockstars as a solution to start virtual machines in Personal Host Pool scenarios is now also available for Pooled Host Pools.&lt;/p&gt;
&lt;p&gt;In this blog you will learn, how to configure Start VM on Connect for Pooled Host Pools, Personal Host Pools and how to shut down VMs, when the users are logging off.&lt;/p&gt;
&lt;h2 id=&#34;prerequisites&#34;&gt;
    &lt;a href=&#34;#prerequisites&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Prerequisites
&lt;/h2&gt;&lt;p&gt;If you want to get started with Start VM on Connect in general you need to know a few things about it. It’s a feature that allows you to start virtual machines, but not yet to stop and deallocate them!&lt;/p&gt;
&lt;p&gt;Additionally, it’s important to mention, that the feature supports ony the following Remote Desktop Clients:&lt;/p&gt;
&lt;p&gt;The WVD web client: (&lt;a class=&#34;link&#34; href=&#34;https://rdweb.wvd.microsoft.com/arm/webclient&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://rdweb.wvd.microsoft.com/arm/webclient&lt;/a&gt;)
The Windows client (from version: 1.2748 or later) – Connect to Windows Virtual Desktop Windows 10 or 7 – Azure | Microsoft Docs
Android client (from version 10.0.10 or later) – (&lt;a class=&#34;link&#34; href=&#34;https://play.google.com/store/apps/details?id=com.microsoft.rdc.androidx&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://play.google.com/store/apps/details?id=com.microsoft.rdc.androidx&lt;/a&gt;)
macOS client (from version 10.6.4 or later) – (&lt;a class=&#34;link&#34; href=&#34;https://apps.apple.com/app/microsoft-remote-desktop/id1295203466?mt=12&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://apps.apple.com/app/microsoft-remote-desktop/id1295203466?mt=12&lt;/a&gt;)
The iOS client is currently NOT supported! Updates can happen at any time to change this.&lt;/p&gt;
&lt;p&gt;To make the feature work in your environment, the second prerequisite is to create a custom role for Start VM on Connect. This can be achieved by granting access to the following set of permissions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Microsoft.Compute/virtualMachines/start/action&lt;/li&gt;
&lt;li&gt;Microsoft.Compute/virtualMachines/read&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;how-to-create-the-custom-role&#34;&gt;
    &lt;a href=&#34;#how-to-create-the-custom-role&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    How to create the custom role
&lt;/h2&gt;&lt;p&gt;First, you have to open your subscription from the Azure Portal. Click on Access control (IAM) to create a custom role.&lt;/p&gt;
&lt;p&gt;In the top center of the screen click on “+Add” to create the new role and select “Add custom role”.&lt;/p&gt;
&lt;p&gt;Now you have to give your role a name. I’ve chosen: “WVD Start VM on Connect”, which allows me to identify the role I need easily. Give your new role a description to understand easily, what this role is for, and click on Permissions.&lt;/p&gt;
&lt;p&gt;Now click on “+Add permissions” and select the permissions you want to grant for this role. Like mentioned above you need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Microsoft.Compute/virtualMachines/start/action&lt;/li&gt;
&lt;li&gt;Microsoft.Compute/virtualMachines/read&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Alternatively, import the following JSON file for your role:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;properties&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;roleName&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;WVDStartVMonConnect&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Custom role for starting VMs for WVD&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;assignableScopes&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;#34;/subscriptions/4faae4e2-2c28-4b36-9002-31ad17a4ded4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;permissions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;actions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;s2&#34;&gt;&amp;#34;Microsoft.Compute/virtualMachines/read&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;s2&#34;&gt;&amp;#34;Microsoft.Compute/virtualMachines/start/action&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;notActions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;dataActions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;nt&#34;&gt;&amp;#34;notDataActions&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Now, click Review + create and confirm another time by clicking “create“.&lt;/p&gt;
&lt;p&gt;Once the task is completed, you will get the following notification.&lt;/p&gt;
&lt;p&gt;As the role is created, you need to assign this custom role to the WVD service. This can be achieved by clicking on “Role assignments” in your subscription, followed by clicking “+Add” &amp;gt; “Add role assignment“.&lt;/p&gt;
&lt;p&gt;Now you just need to pick the recently created role, which is WVDStartVMOnConnect in my case, and assign access to Windows Virtual Desktop as a service. Once this is done, the role assignment completed successfully.&lt;/p&gt;
&lt;h2 id=&#34;enable-start-vm-on-connect-for-pooled-host-pools&#34;&gt;
    &lt;a href=&#34;#enable-start-vm-on-connect-for-pooled-host-pools&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Enable “Start VM on Connect for Pooled Host Pools“
&lt;/h2&gt;&lt;p&gt;On 12 May, Eva Seydl, Program Manager at Microsoft announced the availability of Start VM on Connect for Pooled Host Pools! This is awesome news, because it allows the first user connecting to a turned off Session Host to turn it on an allows an even more flexible way of scaling. Additionally, it allows you to scale down your Virtual Machines to ZERO, which is a huge cost saving opportunity for your environments.&lt;/p&gt;
&lt;p&gt;The following describes the way to configure Start VM on Connect for Pooled Host Pools.&lt;/p&gt;
&lt;p&gt;The important thing you need to know is, that this feature is currently in Preview. For that reason there is no graphical button to turn this feature on and it actually requires PowerShell.&lt;/p&gt;
&lt;p&gt;Now log on to your Azure account with administrative privileges for WVD. Additionally make sure you have the Az.DesktopVirtualization module installed.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Connect-AzAccount&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Import-Module&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Az&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;DesktopVirtualization&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Now you need to identify the Pooled Host Pools in your environment, you can achieve this by the following line of code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Get-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;HostPoolType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Pooled&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;turn-on-the-feature-for-a-single-pooled-hostpool&#34;&gt;
    &lt;a href=&#34;#turn-on-the-feature-for-a-single-pooled-hostpool&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Turn on the feature for a single pooled HostPool
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resourcegroupname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpoolname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;turn-on-the-feature-for-all-pooled-hostpools&#34;&gt;
    &lt;a href=&#34;#turn-on-the-feature-for-all-pooled-hostpools&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Turn on the feature for ALL pooled HostPools
&lt;/h2&gt;&lt;p&gt;Information: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (&lt;a class=&#34;link&#34; href=&#34;https://web.archive.org/web/20230326143059/https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://web.archive.org/web/20230326143059/https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Connect-AzAccount&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ResourceType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DesktopVirtualization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzWVDHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;HostPoolType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Pooled&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;StartVMOnConnect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;$true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;The HostPool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; has the feature already enabled. Continue with the next one&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroup&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Start VM on Connect has been successfully configured for Host Pool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ForegroundColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Green&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;turn-off-the-feature-for-a-single-pooled-hostpool&#34;&gt;
    &lt;a href=&#34;#turn-off-the-feature-for-a-single-pooled-hostpool&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Turn off the feature for a single Pooled HostPool
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resourcegroupname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpoolname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;turn-off-the-feature-for-all-pooled-hostpools&#34;&gt;
    &lt;a href=&#34;#turn-off-the-feature-for-all-pooled-hostpools&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Turn off the feature for all Pooled HostPools
&lt;/h2&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Connect-AzAccount&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ResourceType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DesktopVirtualization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzWVDHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;HostPoolType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Pooled&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;StartVMOnConnect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;$false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;The HostPool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; has the feature already enabled. Continue with the next one&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroup&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Start VM on Connect has been successfully deactivated for Host Pool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ForegroundColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Green&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enable-start-vm-on-connect-for-personal-host-pools&#34;&gt;
    &lt;a href=&#34;#enable-start-vm-on-connect-for-personal-host-pools&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Enable “Start VM on Connect for Personal Host Pools“
&lt;/h2&gt;&lt;p&gt;If you want to enable Start VM on Connect for Personal Host Pools, that’s also not a problem and can easily be achieved by using the Azure Portal. If you wish to do this by PowerShell, this can also be achieved and will be explained in the following subchapters.&lt;/p&gt;
&lt;h2 id=&#34;enable-the-feature-for-a-single-personal-host-pool-azure-portal&#34;&gt;
    &lt;a href=&#34;#enable-the-feature-for-a-single-personal-host-pool-azure-portal&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Enable the feature for a single Personal Host Pool (Azure Portal)
&lt;/h2&gt;&lt;p&gt;The easiest possibility of managing the Start VM on Connect feature is currently (last reviewed 18.05.2021) the Azure Portal. Where it’s not possible to achieve this for Pooled Host Pools, the Microsoft Product Group enabled this feature already for the Personal Host Pools.&lt;/p&gt;
&lt;p&gt;All you need to do is to log into the Azure Portal using: &lt;a class=&#34;link&#34; href=&#34;https://portal.azure.com&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://portal.azure.com&lt;/a&gt; and navigate to the Windows Virtual Desktop Service. Arrived in the Host Pool overview, you will find the Pooled and Personal Host Pool types. We select the Personal Host Pool we want to enable to continue. Now we need to select Properties to find this option.&lt;/p&gt;
&lt;p&gt;As a last step, you only need to enable the “Start VM on Connect” feature, while hitting Yes and clicking on “Save” in the upper corner. That’s it!&lt;/p&gt;
&lt;h2 id=&#34;enable-the-feature-for-all-personal-host-pools-powershell&#34;&gt;
    &lt;a href=&#34;#enable-the-feature-for-all-personal-host-pools-powershell&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Enable the feature for all Personal Host Pools (PowerShell)
&lt;/h2&gt;&lt;p&gt;If you want to enable the feature for all Personal Host Pools, we need to use the PowerShell again. Please use the following script to allow all Personal Host Pools for Start VM on Connect.&lt;/p&gt;
&lt;p&gt;Information: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (&lt;a class=&#34;link&#34; href=&#34;https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Connect-AzAccount&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ResourceType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DesktopVirtualization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzWVDHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;HostPoolType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Personal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;StartVMOnConnect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;$true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                 &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;The HostPool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; has the feature already enabled. Continue with the next one&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroup&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Start VM on Connect has been successfully configured for Host Pool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ForegroundColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Green&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;disable-the-feature-for-personal-host-pools-azure-portal&#34;&gt;
    &lt;a href=&#34;#disable-the-feature-for-personal-host-pools-azure-portal&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Disable the feature for Personal Host Pools (Azure Portal)
&lt;/h2&gt;&lt;p&gt;Disabling the feature for a single Personal Host Pool, is as simple as enabling it. Just follow the steps from the previous subchapter and select “No” in the option field from within the Host Pool property page.&lt;/p&gt;
&lt;h2 id=&#34;disable-the-feature-for-all-personal-host-pools-powershell&#34;&gt;
    &lt;a href=&#34;#disable-the-feature-for-all-personal-host-pools-powershell&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Disable the feature for all Personal Host Pools (PowerShell)
&lt;/h2&gt;&lt;p&gt;If you want to disable the feature for all Personal Host Pools, please use the following script. Information: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (&lt;a class=&#34;link&#34; href=&#34;https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;Connect-AzAccount&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzResource&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Where-Object&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ResourceType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DesktopVirtualization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;hostpools&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$AllHostPools&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Get-AzWVDHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroupName&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;HostPoolType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Personal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;StartVMOnConnect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-eq&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;$false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;The HostPool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34; has the feature already enabled. Continue with the next one&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Update-AzWvdHostPool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-Name&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ResourceGroup&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$HostPool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;ResourceGroupName&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-StartVMOnConnect:&lt;/span&gt;&lt;span class=&#34;vm&#34;&gt;$false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                    &lt;span class=&#34;nb&#34;&gt;Write-Host&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Start VM on Connect has been successfully deactivated for Host Pool &amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$HostPoolValidation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-ForegroundColor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Green&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;enable-shutdown-virtual-machines-at-logoff&#34;&gt;
    &lt;a href=&#34;#enable-shutdown-virtual-machines-at-logoff&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Enable “Shutdown virtual machines at LogOff“
&lt;/h2&gt;&lt;p&gt;A few weeks ago, Microsoft Global Black Belt Bernd Löhlein blogged about shutting down the Session Hosts and deallocating them, to not consume more money from your subscription, when the users log off. The solution is great for Personal Host Pools, but shouldn’t be used with Pooled Host Pools, as there might be more people working on the Session Host concurrently. Please find Bernd’s blog here: (&lt;a class=&#34;link&#34; href=&#34;https://techcommunity.microsoft.com/t5/windows-virtual-desktop/deallocate-vm-on-user-logoff/m-p/2280211&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://techcommunity.microsoft.com/t5/windows-virtual-desktop/deallocate-vm-on-user-logoff/m-p/2280211&lt;/a&gt;)&lt;/p&gt;
&lt;h2 id=&#34;shutting-down-pooled-session-hosts&#34;&gt;
    &lt;a href=&#34;#shutting-down-pooled-session-hosts&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Shutting down Pooled Session Hosts
&lt;/h2&gt;&lt;p&gt;To achieve this we have two possibilities:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Shutting down the virtual machines based on a time based metric&lt;/li&gt;
&lt;li&gt;Using the WVDLogix Autoscale Tool to scale down machines&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To shut down the VMs based on a time based metric, we need to create an Automation Account in our subscription.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image.png&#34;
	width=&#34;682&#34;
	height=&#34;342&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image_hu053f6ecd58df2510c95ac837fcb6de50_88227_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image_hu053f6ecd58df2510c95ac837fcb6de50_88227_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;199&#34;
		data-flex-basis=&#34;478px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;On the next page, we´ll give our Automation Account a name, select the subscription, the RG we´ve created, and the operating location, which is West Europe in my case. You also have the possibility to create a RunAs Account, which is not needed for the solution, which we´re going to provision right afterwards. Hit “Create” once you´re finished.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-1.png&#34;
	width=&#34;371&#34;
	height=&#34;1024&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-1_hu9ec759cac849b289ce22d31f9c047f14_258271_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-1_hu9ec759cac849b289ce22d31f9c047f14_258271_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;36&#34;
		data-flex-basis=&#34;86px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;After a few seconds, our storage account is ready to be used and we can go to the resource, which presents us the basic overview of an Automation account.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-2.png&#34;
	width=&#34;1024&#34;
	height=&#34;823&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-2_hu2fb28a82cb71bb555a297d41dda1e6f2_466115_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-2_hu2fb28a82cb71bb555a297d41dda1e6f2_466115_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;124&#34;
		data-flex-basis=&#34;298px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;In here, we need to scroll down on the left hend side until we reach “Start/Stop VM”, which is the solution we want to install.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-3.png&#34;
	width=&#34;832&#34;
	height=&#34;705&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-3_hud409c485d1e58c445ea7536ec39e4073_250570_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-3_hud409c485d1e58c445ea7536ec39e4073_250570_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;118&#34;
		data-flex-basis=&#34;283px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;It´s obvious that we´re going to click on “Create”, but I´m very excited to see, what you´re saying about what this solution delivers additionally, when correctly configured. For now we click “Create” again to provision the solution.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-4.png&#34;
	width=&#34;823&#34;
	height=&#34;317&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-4_hud5c1f4708f7a58db907aa91021ab34f9_105114_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-4_hud5c1f4708f7a58db907aa91021ab34f9_105114_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;259&#34;
		data-flex-basis=&#34;623px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;The agent will guide us through the deployment of the solution, which requires the following components:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Log Analytics Workspace (Can be created from within the solution deployment)&lt;/li&gt;
&lt;li&gt;Azure Automation Account (which has been created previously)&lt;/li&gt;
&lt;li&gt;Parameters&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-5.png&#34;
	width=&#34;787&#34;
	height=&#34;704&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-5_hu8172b88afe41ccb92eb176903ffdcd0b_154315_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-5_hu8172b88afe41ccb92eb176903ffdcd0b_154315_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;111&#34;
		data-flex-basis=&#34;268px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;After you´ve created the Log Analytics Workspace and select the Automation Account created by us earlier, we leave the parameters empty for the moment. To not hide the possibilities from you, here is the screenshot of the initial configuration, to be defined from over here already.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-6.png&#34;
	width=&#34;773&#34;
	height=&#34;733&#34;
	srcset=&#34;http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-6_hu1cd23b2dfdb2e5df852f9c186dfa1331_197962_480x0_resize_box_3.png 480w, http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/image-6_hu1cd23b2dfdb2e5df852f9c186dfa1331_197962_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;105&#34;
		data-flex-basis=&#34;253px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;As mentioned before, we keep it empty and hit “OK” and click “Create”.&lt;/p&gt;
&lt;p&gt;The deployment process is going to start and will finalize between 10-15 minutes and this will shutdown all machines, based on a time based metric automatically.&lt;/p&gt;
&lt;p&gt;&lt;b&gt; My personal recommendation is clearly to use the Autoscaling engine! &lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Thank you for reading this article!&lt;/p&gt;
&lt;p&gt;Cheers,
Patrick&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Turn off “News and Interests” taskbar widget for Windows 10 Enterprise Multi-Session</title>
        <link>http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/</link>
        <pubDate>Thu, 29 Jul 2021 16:56:47 +0600</pubDate>
        
        <guid>http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/</guid>
        <description>&lt;img src="http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/title.png" alt="Featured image of post Turn off “News and Interests” taskbar widget for Windows 10 Enterprise Multi-Session" /&gt;&lt;p&gt;A feature that came with the latest Windows Update is the “News and Interests” taskbar widget for Windows 10. A feature that might make sense for the user experience on stationary PC’s is definetly something that can confuse users in multi-session environments – like such on Azure Virtual Desktop.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/image.png&#34;
	width=&#34;650&#34;
	height=&#34;573&#34;
	srcset=&#34;http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/image_hue232e807b761c8b4e4e982651bf6d91e_122963_480x0_resize_box_3.png 480w, http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/image_hue232e807b761c8b4e4e982651bf6d91e_122963_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;113&#34;
		data-flex-basis=&#34;272px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;How you can easily turn this feature off is what we’re covering in today’s blog post!&lt;/p&gt;
&lt;h2 id=&#34;turn-off-the-feature-via-group-policy--registry&#34;&gt;
    &lt;a href=&#34;#turn-off-the-feature-via-group-policy--registry&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Turn off the feature via Group Policy / Registry
&lt;/h2&gt;&lt;p&gt;The easiest way I would recommend deactivating the features for all users is via Group Policy. As there is currently no official option to turn this feature off, you can achieve this by using a registry key.&lt;/p&gt;
&lt;p&gt;Navigate to the Group Policy Management console on your Active Directory server and create a new Registry Key for your Session Hosts:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;HKEY_CURRENT_USER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Software&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Windows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CurrentVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Feeds&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Create a new entry:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Type&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;DWORD&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ShellFeedsTaskbarViewMode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Value&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;2&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;b&gt;IMPORTANT! Value “2” deactivates the feature in the next couple of minutes from the virtual machine. If the value is set to “0”, the feature remains enabled!&lt;/b&gt;&lt;/p&gt;
&lt;p&gt;That’s it! With that trick you can deactivate the widget easily.&lt;/p&gt;
&lt;p&gt;Nevertheless I would be interested to know your opinion about the feature! Do you any sense in keeping it enabled on multi-session VMs? Let me know!&lt;/p&gt;
&lt;p&gt;Cheers,
Patrick&lt;/p&gt;
</description>
        </item>
        <item>
        <title>FSLogix v2105 – How to Increase VHDX size of profile container</title>
        <link>http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/</link>
        <pubDate>Tue, 27 Jul 2021 16:56:47 +0600</pubDate>
        
        <guid>http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/</guid>
        <description>&lt;img src="http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/title.png" alt="Featured image of post FSLogix v2105 – How to Increase VHDX size of profile container" /&gt;&lt;p&gt;Hi and welcome to my latest blog post about Azure Virtual Desktop and FSLogix v2105.&lt;/p&gt;
&lt;p&gt;On the 12th of July, Microsoft announced a new version of FSLogix, which has a bunch of features, that could help you in maintaining your profiles. In this blog post, we will focus on: “How to increase the vhd/vhdx profile size” without the need for PowerShell or any migration of profile data into a new container.&lt;/p&gt;
&lt;p&gt;But let’s start with a question that I previously get to show you the real advantage of this new capability.&lt;/p&gt;
&lt;h2 id=&#34;what-is-the-default-size-and-is-that-not-enough-for-most-use-cases&#34;&gt;
    &lt;a href=&#34;#what-is-the-default-size-and-is-that-not-enough-for-most-use-cases&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    What is the default size, and is that not enough for most use cases?
&lt;/h2&gt;&lt;p&gt;As many of you know, an FSLogix default profile has a maximum size of 30GB per profile disk. For most use cases this should be absolutely sufficient, however, there are quite a few examples, where this isn’t enough (Hotline / HelpDesk workers with a lot of data that needs to be available in the profile and where OneDrive isn’t an option).&lt;/p&gt;
&lt;p&gt;So you had two options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Consider a right sizing from the beginning and configure the SizeInMB registry / GPO setting accordingly&lt;/li&gt;
&lt;li&gt;Migrate the files to a container with an increased size and migrate the data properly and set the permissions&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As you can imagine, both options aren’t really optimal from the administration’s perspective.&lt;/p&gt;
&lt;h2 id=&#34;how-to-i-increase-the-fslogix-profile-size-using-version-2105&#34;&gt;
    &lt;a href=&#34;#how-to-i-increase-the-fslogix-profile-size-using-version-2105&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    How to I increase the FSLogix Profile size using version 2105?
&lt;/h2&gt;&lt;p&gt;First, you need to perform the update to version 2105 from your current version. This can easily be achieved by downloading the installer files from Microsoft here.&lt;/p&gt;
&lt;p&gt;You just need to install the application and restart the system to apply the update.&lt;/p&gt;
&lt;p&gt;&lt;b&gt; Attention! Ensure that no users are logged on the system, while you’re performing the update to avoid data loss. Also, try to not log on with a user, that owns an FSLogix profile otherwise, you risk that your profile is corrupted. &lt;/b&gt;&lt;/p&gt;
&lt;p&gt;Now you need to follow these easy steps to achieve the profile increasing:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Connect to your available Domain Controller, where you’re using the FSLogix Administrative Templates (available from the download link above)&lt;/li&gt;
&lt;li&gt;Navigate to the Group Policy Management mmc.&lt;/li&gt;
&lt;li&gt;Create a new Group Policy Object or navigate to your existing one (shown in my example below)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image.png&#34;
	width=&#34;320&#34;
	height=&#34;268&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image_hu4cebe46fbef63254684ef42a9ec5c4b4_19109_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image_hu4cebe46fbef63254684ef42a9ec5c4b4_19109_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;119&#34;
		data-flex-basis=&#34;286px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Perform a right click and click on “Edit”&lt;/li&gt;
&lt;li&gt;Navigate to “Computer Configuration / Administrative Templates / FSLogix / Profile Containers“&lt;/li&gt;
&lt;li&gt;Adjust the setting “Size in MBs” and set it to your preferred value. The increasing of the profile disk will become active, once the user logs on again.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-1.png&#34;
	width=&#34;686&#34;
	height=&#34;636&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-1_huc8a59454a3075309b66239db6fad8f98_25200_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-1_huc8a59454a3075309b66239db6fad8f98_25200_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;107&#34;
		data-flex-basis=&#34;258px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Once the user logged in, you can verify the change while navigating in your Windows Explorer to: “C:\Program Files\FSLogix\Apps” and open the frxtray.exe to see the current status of the profile.&lt;/li&gt;
&lt;li&gt;Make a double click on the green light, which opens the tool to verify the new maximum profile size.&lt;/li&gt;
&lt;li&gt;As you can see the new profile size has directly been applied.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-3.png&#34;
	width=&#34;859&#34;
	height=&#34;174&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-3_hub322ec6da8f1cf4b5ad856b53712267a_12871_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-3_hub322ec6da8f1cf4b5ad856b53712267a_12871_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;493&#34;
		data-flex-basis=&#34;1184px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;b&gt; If I’m not able to upgrade to v2105, how do I increase the profile size with option 2 mentioned above? &lt;/b&gt;
If you still need to perform the increasing of the profile disk manually, you have to follow these steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Connect to a session host / virtual machine that has the FSLogix Apps installed&lt;/li&gt;
&lt;li&gt;Navigate to: “C:\Program Files\FSLogix\Apps”&lt;/li&gt;
&lt;li&gt;Collect the actual disk file of the profile that you want to increase. In my example this is a profile located on a storage account, that I’ve mounted using drive letter “Z”. E.g. Z:\sstrange\sstrange.vhdx&lt;/li&gt;
&lt;li&gt;&lt;b&gt; IMPORTANT! Make sure to create a backup of the disk to avoid any corruption that could occur! &lt;/b&gt;&lt;/li&gt;
&lt;li&gt;Use the following command to increase the size from 30GB to 35GB:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;frx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;migrate-vhd&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-src&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Z:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sstrange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Profile_sstrange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;vhdx&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-dest&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Z:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sstrange&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Profile_sstrange_increased&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;vhdx&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-size-mbs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;35840&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;-dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-4.png&#34;
	width=&#34;1024&#34;
	height=&#34;175&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-4_hu01ca3f50f637a1cb760e6ed6dabc9ae1_161556_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-4_hu01ca3f50f637a1cb760e6ed6dabc9ae1_161556_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;585&#34;
		data-flex-basis=&#34;1404px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;b&gt; ATTENTION! If you might see an error coming up while migrating/increasing the user’s profile that sounds like: &lt;/b&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Error Mirroring files (0x0000001D): The system cannot write to the specified device.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;This is most likely due to cache files that couldn’t be copied to the new disk files (most likely coming from Microsoft Edge cache). You can ignore this error for now and continue with the next step.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Now you need to rename the profile, now that you have the previous and the new one. This means that you would need to rename Profile_sstrange.vhdx to Profile_sstrange_old.vhdx and Profile_sstrange_increased.vhdx to Profile_sstrange.vhdx. (Apply to your current naming settings defined in FSLogix). The result could look like this:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-5.png&#34;
	width=&#34;536&#34;
	height=&#34;110&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-5_hu9e1522e42b4f9f39d988862b88afc3e4_10631_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-5_hu9e1522e42b4f9f39d988862b88afc3e4_10631_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;487&#34;
		data-flex-basis=&#34;1169px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Now keep the old profile and advise the user to perform a login test before removing the old profile.&lt;/li&gt;
&lt;li&gt;Once the user logged in, you can verify the change while navigating in your Windows Explorer to: “C:\Program Files\FSLogix\Apps” and open the frxtray.exe to see the current status of the profile.&lt;/li&gt;
&lt;li&gt;Make a double click on the green light, which opens the tool to verify the new maximum profile size.&lt;/li&gt;
&lt;li&gt;As you can see the new profile size has directly been applied.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-6.png&#34;
	width=&#34;859&#34;
	height=&#34;174&#34;
	srcset=&#34;http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-6_hub322ec6da8f1cf4b5ad856b53712267a_12871_480x0_resize_box_3.png 480w, http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/image-6_hub322ec6da8f1cf4b5ad856b53712267a_12871_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;493&#34;
		data-flex-basis=&#34;1184px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;As you have seen, the new version 2105 with the capability of increasing the profile disk size will help customers a lot. It’s a very streamlined administrative experience that does exactly what it should. The results can be verified and work perfectly with FSLogix Cloud Cache as well!&lt;/p&gt;
&lt;p&gt;I can just recommend performing the task via Group Policy if you want to apply the setting at a global scale, rather than doing it via Group Policy.&lt;/p&gt;
&lt;p&gt;Nevertheless, there is one remark I want to make in terms of implementing this change. Keep in mind that all users, that have the right to use an FSLogix profile will be targeted with this setting, which leads into problems with your current allocated storage capacity! Make sure to keep your scoping right, or perform the manual way of doing it as stated in chapter “If I’m not able to upgrade to v2105, how do I increase the profile size with option 2 mentioned above?” if that fix should be applied to only a single / bunch of users.&lt;/p&gt;
&lt;p&gt;If you have any questions, write them down in the comments and I will try to answer them asap!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>How to reset the Remote Desktop Client on Windows 10 &amp; 11</title>
        <link>http://localhost:1313/p/how-to-reset-the-remote-desktop-client-on-windows-10-11/</link>
        <pubDate>Mon, 14 Jun 2021 16:56:47 +0600</pubDate>
        
        <guid>http://localhost:1313/p/how-to-reset-the-remote-desktop-client-on-windows-10-11/</guid>
        <description>&lt;img src="http://localhost:1313/p/how-to-reset-the-remote-desktop-client-on-windows-10-11/title.png" alt="Featured image of post How to reset the Remote Desktop Client on Windows 10 &amp; 11" /&gt;&lt;p&gt;Welcome to this very quick blog post about a topic that you may have experienced while enabling customers to use Azure Virtual Desktop. You installed the latest version on a computer and everything works fine, until the Remote Desktop app starts to crash frequently, or connections aren’t possible anymore. In some rare cases, you can’t even click anywhere.&lt;/p&gt;
&lt;p&gt;For that reason, you can reset the Remote Desktop Client on Windows easily via PowerShell.&lt;/p&gt;
&lt;p&gt;The feature is available from version 1.2.790, which has been released already in 2020.&lt;/p&gt;
&lt;p&gt;Just run this small line of code and you’ll be fine again:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;C:\Program Files\Remote Desktop\&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;msrdcw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;exe&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reset&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;I hope this helps in case that you encounter that kind of issue one day.&lt;/p&gt;
&lt;p&gt;Cheers,
Patrick&lt;/p&gt;
</description>
        </item>
        <item>
        <title>What you have to know about the WVD Required URL check tool</title>
        <link>http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/</link>
        <pubDate>Tue, 20 Apr 2021 16:56:47 +0600</pubDate>
        
        <guid>http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/</guid>
        <description>&lt;img src="http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/title.png" alt="Featured image of post What you have to know about the WVD Required URL check tool" /&gt;&lt;p&gt;On 16.04.2021 Tom Hickling (&lt;a class=&#34;link&#34; href=&#34;https://twitter.com/@tomhickling&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://twitter.com/@tomhickling&lt;/a&gt;) announced via LinkedIn, that Microsoft released a tool to validate that Session Hosts can reach the required services to ensure full connectivity to the WVD services.&lt;/p&gt;
&lt;p&gt;The tool is built to present you the URLs which are accessible or not, if that’s the case. However there are a few things you need to keep in mind, before running the tool.&lt;/p&gt;
&lt;p&gt;In this blog, I will tell you what you must know about the URLs and ports to be opened for WVD, as well as what the required URL check tool can do for not and what it can’t do!&lt;/p&gt;
&lt;h2 id=&#34;which-urls-and-ports-are-required-for-a-session-host-to-connect-to-the-wvd-backplane&#34;&gt;
    &lt;a href=&#34;#which-urls-and-ports-are-required-for-a-session-host-to-connect-to-the-wvd-backplane&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Which URLs and ports are required for a Session Host to connect to the WVD backplane?
&lt;/h2&gt;&lt;p&gt;Let’s start with the first question on which URLs and ports you need to open to let your Session Hosts access the WVD backplane. You will see a few URLs with an asterisk (*), or a wildcard in front of the URL, you have to know that the WVD required URL check tool is NOT able to resolve or check against those, so you have to ensure proper connectivity.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image.png&#34;
	width=&#34;846&#34;
	height=&#34;670&#34;
	srcset=&#34;http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image_hu1c892ca0e5535204f2c472a240144391_93805_480x0_resize_box_3.png 480w, http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image_hu1c892ca0e5535204f2c472a240144391_93805_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;126&#34;
		data-flex-basis=&#34;303px&#34;
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;is-there-an-easier-way-to-enable-the-required-ports-if-im-using-azure-firewall&#34;&gt;
    &lt;a href=&#34;#is-there-an-easier-way-to-enable-the-required-ports-if-im-using-azure-firewall&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Is there an easier way to enable the required ports if I’m using Azure Firewall?
&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image-1.png&#34;
	width=&#34;2700&#34;
	height=&#34;1393&#34;
	srcset=&#34;http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image-1_hu86dfc430d4e7e505b1ffb978c4dea9ff_928583_480x0_resize_box_3.png 480w, http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/image-1_hu86dfc430d4e7e505b1ffb978c4dea9ff_928583_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;alt text&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;193&#34;
		data-flex-basis=&#34;465px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;In case that you’re using Azure Firewall you’re lucky, because Microsoft provides FQDN Tags for Windows Virtual Desktop, which enables the service in just a few clicks. So you don’t need to open the ports / URLs one by one, as you can simply select the service Tag “Windows Virtual Desktop”.&lt;/p&gt;
&lt;p&gt;Just navigate to your Azure Firewall and select a Firewall Policy. Here you can find “Application Rules“, create a new rule, and select the IP address range of your WVD Session Hosts or any by typing “*” and select “Destination Type” FQDN Tag. Now you can simply select “WindowsVirtualDesktop” from the dropdown list and click save until you’re ready to go.&lt;/p&gt;
&lt;h2 id=&#34;what-are-the-requirements-for-the-wvd-required-urls-check-tool&#34;&gt;
    &lt;a href=&#34;#what-are-the-requirements-for-the-wvd-required-urls-check-tool&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    What are the requirements for the WVD required URLs check tool
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;WVD Host Pool with deployed Session Hosts (as this script/tool is intended to run from inside the VM)&lt;/li&gt;
&lt;li&gt;.NET 4.6.2 framework must be installed on your Session Host&lt;/li&gt;
&lt;li&gt;RDAgent version 1.0.2944.400 or higher&lt;/li&gt;
&lt;li&gt;The WVDAgentUrlTool.exe file must be in the same folder as the WVDAgentUrlTool.config file&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;how-to-execute-the-tool&#34;&gt;
    &lt;a href=&#34;#how-to-execute-the-tool&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    How to execute the tool
&lt;/h2&gt;&lt;p&gt;First you need to open the Powershell and navigate to the RD Infrastructure Agent folder.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;C:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Program&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Microsoft&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;RDInfra&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;RDAgent_1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;2944&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;1200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Now you just need to execute the WVDAgentURLTool.exe and you’ll get the results after a few seconds presented.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-powershell&#34; data-lang=&#34;powershell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;.\&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WVDAgentUrlTool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;exe&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;As you can see from the results, some URLs from the list above are missing in the tool, therefore it’s mandatory to verify the mentioned required URLs before executing the tool.&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;
    &lt;a href=&#34;#conclusion&#34; class=&#34;header-anchor&#34;&gt;#&lt;/a&gt;
    Conclusion
&lt;/h2&gt;&lt;p&gt;The WVD URL Check Tool is a great way of quickly checking the connectivity to the WVD services for your Session Hosts, but you have to keep in mind that you still have some prerequisites to fullfil before you can trust the result and ensure 100% connectivity to the service.&lt;/p&gt;
&lt;p&gt;If you want to know more about the tool or have general questions about WVD connectivity feel free to reach out to me at any time!&lt;/p&gt;
&lt;p&gt;Cheers,&lt;/p&gt;
&lt;p&gt;Patrick&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
