[{"content":"Hey everybody it\u0026rsquo;s Patrick again from the new blog site (yes I finally made it to GitHub with a static page build with Hugo),\nthis time I want to share my story around why I believe the vExpert program has helped me become a better architect. As some of you know, I started my IT career already a while back in 2009 where I completed an apprenticeship at IT-Haus (a local German consulting firm and reseller). I started to dig deeper into emerging technologies, got my first steps in vCenter done, learned how cool vMotion is and what it means to host and manage larger IT estates. Moving forward in my career I brought cloud technologies like Microsoft Azure, Amazon Web Services etc. to the mix and I transitioned slightly from the on-premises three tier architecture towards more cloud consultancy.\nBut from who did I learn all these things, and what are my resources? Is something I got asked frequently. And to tell you the trough, besides reading books and searching the internet for the solutions I needed, most of the time I landed on pages from vExperts, MVP\u0026rsquo;s etc. Those guys I considered as my rockstars (and they obviously are) in the industry. The knowledge they shared, the passion for technology combined with the willing to help the community inspired me a lot, which is the reason why I started my first blog page back in 2020 with wvdlogix.net. The blog should help me get into EUC and to share my thoughts around Azure Virtual Desktop, VMware Horizon and later on the combination of both.\nAfter one year of blogging I thought that I should give it a try to apply for the vExpert program, as I want to contribute even more to the awesome community and to learn how to ask the right questions and to help the product team to even improve the technology that we love and that we kind of grew up with.\nAnd it happened! I got accepted for the first time to become a VMware vExpert myself in 2021. Which by the way should later be the year when I join the incredible company VMware is.\n# But what did the vExpert program supported you with? First of all, it\u0026rsquo;s important to mention that the vExpert program is meant to share knowledge and to collaborate with other tech enthusiasts. That was the first support and one of the most important things I always mention when somebody asks me about the program. I got access to the group of people via Slack where I was able to ask questions, share my thoughts and get comments and ideas on other peoples experience which helped me also a lot in improving the content that I\u0026rsquo;m sharing with the community.\nIt\u0026rsquo;s a great place and actually one of the greatest assets of the program to get access to these fantastic people!\nSecond, it was the licenses for your lab infrastructure. These helped me a lot to improve my architecture and automation skills while implementing the technology in my homelab, tinkering around with the VCF stack, destroying it, rebuilding and starting to become more solid in my conversations with customers which indeed helped to become a better architect. And this again helped me to become a better community member who wants to share expert knowledge and experiences with others.\nBesides all of that there is a fantastic community lead named Corey Romero, who build the program and has several opportunities and events for you to learn from the product groups and get into deep technical details!\n# But what do I need to do to become a vExpert? To become a vExpert yourself it\u0026rsquo;s important to understand that this recognition is not only a badge to polish your CV, it\u0026rsquo;s also not just an entitlement, it means dedication and willigness to support. To be part of the community a good thing is to connect with other vExperts or vExperts pro via Twitter / X or LinkedIn and ask them for guidance and support (I\u0026rsquo;m sure most of them will be open to support! Otherwise reach out to me at any time). Next should be that you start to blog! Write about your experiences, start to share knowledge regardless how easy it may seem to you, I\u0026rsquo;m sure somebody else with profit from it! Next could be to sign up for a variety of VMUGs (VMware User Groups or UserCons) or even speak at those events! And if you are new to speaking, ask the vExpert community again to provide you with tips and tricks and help to get you prepared for your first showtime, I\u0026rsquo;m sure everybody is willing to help!\nOnce you get into blogging and speaking, it may be time to apply for the vExpert program at https://vexpert.vmware.com\nThere you have to select if you are an Evangelist, customer, partner, VCDX, Moderator or VMUG Leader and provide as much details as you can to your application! After the registration / application time closes you will be notified if you are eligible to become a vExpert!\n# But what happens if I didn\u0026rsquo;t get the vExpert status? Don\u0026rsquo;t worry! Sometimes it takes time and patience. Most importantly is, that you do what you love and share knowledge with the wider community. If you need any assistance please feel free to reach out and I try to be as supportive as I can!\nCheers, Patrick\n","date":"2024-04-22T12:50:47+06:00","image":"http://localhost:1313/p/how-the-vexpert-program-helped-me-to-become-a-better-cloud-architect./title_hu47f31a060c17741ed671fdc891fc1e2a_99060_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/how-the-vexpert-program-helped-me-to-become-a-better-cloud-architect./","title":"How the vExpert program helped me to become a better Cloud architect."},{"content":"Welcome back to my article series on VMware Horizon Cloud on Microsoft Azure. In the previous articles, we have learned what is needed to prepare the infrastructure to be able to enroll new virtual desktop via the VMware Universal Console. We went through the initial Azure configuration and had a look on how to prepare the certificate for the UAG setup, which we will complete in this tutorial. If you missed my previous articles, please find them hereafter: In this article, I will walk you through the configuration settings to enroll our first cloud based POD on Microsoft Azure. Table of Contents Prepare a Service Principal for the VMware Universal Console Before we can start to configure the Universal Console and create the core infrastructure, we need to ensure that we equip our account with administrative privileges in a secure way. For that reason we require to have a Service Principal in place that provides the console with the necessary rights in our tenant, while ensuring that no passwords are exchanged in clear text. To do so, please login to the Azure portal via https://portal.azure.com and select Azure Active Directory.\nIn the following window, we need to select App registrations to be able to create our Service Account.\nOnce, we entered the App registrations view, click on “+ New registration” in the top center of the screen.\nNow we can provide our Service Principal a random name that we want to assign, in my case I name the principal based on the naming convention from the previous article. Make sure to change the Redirect URI to “Web” and provide the URL “http://localhost:8000“. Once we provided the information, click on “Register” to complete the creation. Name: SP-HZNC-AVDLogix Redirect URI: Web URI: http://localhost:8000\nAttention! Once the Service Principal has been create make sure to copy the following information and store them in a safe location, as you will need them for later.\nCopy the application (client) ID and Directory ID (Azure AD tenant ID)\nOnce you noted down the information, we navigate to “Certificates \u0026amp; secrets” on the left hand side to generate the required secret.\nIn here we need to click on “+ New client secret” and provide a client secret description, which is “Client Secret Horizon” in my case and we set the duration to “24 months“. You can also choose a lower time, before the secret expires, but you have to keep in mind to regenerate the secret and update the Universal Console to not lose access or control over the resources.\nAttention! Please make sure to copy the Secret Value once you see it, because it will only appear once like this. In case that you missed to copy it, you need to regenerate the client secret.\nCreate a Custom Role for Service Principal (Least Privileges) Now we are nearly finished with our Service Principal creation, but need to equip it with the required permissions in order to perform tasks in our environment. While doing this we have two options. First, we can assign Contributor rights to our new Service Principal on our subscription, which provides quite a lot of permissions, which we might don’t want if we want to follow the principal of least permissions.\nI recommend creating a custom role, with only the required rights, the Service Principal needs on our subscription. I found an article on the VMware KB, stating the creation of the custom role, which unfortunately doesn’t work for my tenant, for that reason, I’m sharing with you the steps that worked out for me. To do so, we switch to the Subscription menu in our Azure tenant, while searching for “Subscriptions” or selecting it from the portal menu.\nNow, we switch to the Access control (IAM) menu on the left hand side, clicking on “+ Add” and selecting “Add custom role” as the following step.\nNow we need to provide the name for our custom role, I called mine “CR-AVDLogix-HorizonCloudAzure“. Select “Start from scratch” as the Baseline permission and continue to the “JSON” tab by clicking “Next” two times or by directly clicking on “JSON“\nIn the JSON menu, click the edit button on the right hand side, and navigate to the “Actions”: section, where you have to paste the following code, with the named permissions required.\n","date":"2023-12-14T16:56:47+06:00","image":"http://localhost:1313/p/mastering-vmware-horizon-cloud-on-azure-configuring-uag-setup/title_hu47f31a060c17741ed671fdc891fc1e2a_100651_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/mastering-vmware-horizon-cloud-on-azure-configuring-uag-setup/","title":"Mastering VMware Horizon Cloud on Azure - Configuring UAG Setup"},{"content":"Welcome back everyone to the next chapter of the Mastering Horizon Cloud on Azure article series. In the past articles, I have shown you how to setup the Azure subscription, Resource Groups, networks and accounts as well as the creation of the first POD infrastructure on Azure. In this article, we’re going to complete the setup by enabling the infrastructure to authenticate to the domain controller, that you should have in place on Azure or on-premises. In addition to that we will configure the Broker and will enable monitoring.\n# Configure Active Directory To allow our users with a familar experience, we need to ensure that we bind our Active Directory domain to the Horizon POD. This allows us to entitle users to consume the desktop services that we will provision at a later time. After signing in to the Horizon Universal Console using: https://cloud-de.horizon.vmware.com/ We will be back in the Getting Started guide, where we left of in the previous chapter.\nIn this chapter we will primarely focus on working on the second tab, which we will need to expand to complete the general setup. To configure the Active Directory connection, we need to click on “Configure” on the right hand site of Active Directory.\nIn order to bind the Horizon POD to the domain the following information must be filled out prior clicking on “Domain Bind”.\nNetBIOS Name: NetBIOS name of your domain. E.g. avdlogix DNS Doman Name: Full DNS name of your domain. E.g. avdlogix.com Protocol: LDAP (by default) Bind username: A service account that you should create upfront in your AD. E.g. horizonadmin Bind password: The corresponding password to the horizonadmin account. Auxiliary Account Bind username: An alternative service account for Horizon. E.g. svc_horizon Bind password: The corresponding password Port: 389 (LDAP) or 636 (LDAPS) are supported Domain Controller IP: In case that the name cannot be resolved the DC can be contacted by IP Context: Search context within the domain\nOnce all the settings have been made, click on “Domain Bind” to perform the operation. On the following page, you have to provide the information about the DNS server and the default OU you want VMs to join in. Provide the information that are right for your environment and finalize the setup by clicking on “Save”.\nFinally, provide information about the Horizon Admins that you want to enable in your environment. The picture below shows Domain Admins, I highly recommend to choose another group over domain admins, but just wanted to point this out.\nClick on “Save” to finalize the setup. Afterwards you get signed out by the Horizon Universal Console and log back in using first the VMware Account followed by an Admin Account from the group that we have just defined.\nAfter a successful sign-in you will be welcomed by the VMware Universal Console dashboard.\n","date":"2023-03-27T16:56:47+06:00","image":"http://localhost:1313/p/mastering-vmware-horizon-cloud-on-azure-configuring-active-directory-and-broker/title_hu47f31a060c17741ed671fdc891fc1e2a_80306_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/mastering-vmware-horizon-cloud-on-azure-configuring-active-directory-and-broker/","title":"Mastering VMware Horizon Cloud on Azure – Configuring Active Directory and Broker"},{"content":"Welcome to part 4 (actually 5) of the series on how to integrate Workspace ONE Access with Microsoft Azure and Horizon resources on-premises and in the Azure cloud.\nIn this smaller part of the series, we’re highlighting the integration of Horizon (on-premises) assignments to Workspace ONE Access, including the capability of using the Workspace ONE mode, which is a dedicated mode to redirect the authentication for all Horizon sign ins to Workspace ONE Access.\n# Enabling SAML authentication on the Horizon Connection Server(s) As I’m working in a smaller lab environment, I only have one Connection Server hosted on-premises. However, the following steps must be repeated for every server in your on-premises environment.\nBefore we can actually start to synchronise our assignments, we must ensure that Horizon and Workspace ONE Access speak “the same language”, which in this case is the usage of SAML authentication, which must first be configured on the Connection Server level.\nOpen up your preferred browser and navigate to your Administration console of the Horizon Connection Server. Then navigate to Settings \u0026gt; Servers \u0026gt; Connection Servers (tab).\nNow highlight the Connection server, for which you want to enable SAML authentication and click on the Edit button above.\nUp next, we see a new pop up opening and navigate to Authentication, where we switch the Delegation of authentication to VMware Horizon (SAML 2.0 Authenticator) from Disallowed to Allowed. To configure the SAML authenticators, select Manage SAML Authenticators below.\nOn the following screen, proceed by clicking Add. Now you must provide the information matching the Workspace ONE Access environment. The value Label is only an identifier for administrative purposes. The important part is the Metadata URL which must match your internally and externally reachable domain. In my case this is https://access.avdlogix.com/SAAS/API/1.0/metadata.idp.xml. As shown in the screen below. When all the settings have been corrected, apply by clicking “OK”.\nConfirm the configuration to proceed with the next step.\n# Configuring the Workspace ONE Access Connector appliance for entitlement synchronisation An important step which is often overseen is the reconfiguration / import of the certificate of the Connection server into the Workspace ONE Access Connector appliance. This will be required to trust the certificate used by the Connection Server, when establishing a secure connection.\nTo apply the configuration I make sure to connect to the Access Connector VM we’ve created in the previous parts, download the certificate from the Horizon Connection Server and go to Control Panel \u0026gt; Programs \u0026gt; Programs and Features and click Change on the Workspace ONE Access Connector installer.\nConfirm by clicking Add / Remove Services and click on Next \u0026gt;.\nOn the next page, the installer allows you to adjust the installation services. Make sure that Virtual App Service is installed before proceeding by clicking Next \u0026gt;.\nIf you are using a Proxy or Syslog server, you have the change to configure it at the next following pages, if this isn’t the case proceed (and also skip the Citrix configuration part), until you reach the point “Trust Root Certificates”.\nOn this screen click browse and select the Horizon Connection Server certificate.\nOnce you’ve selected the certificates, you can validate that they’re correctly recognized by the installer by clicking “Cert Details..”. If the certificates have been imported correctly, proceed by clicking Next \u0026gt;.\nProceed over the next pages by clicking Next \u0026gt;. Stop at the Servic Account level, where you have to provide your credentials again for the Sync service.\nConfirm by clicking the check box on “Do you want to restart already installed services and complete this task by clicking Install.\n","date":"2023-01-25T16:56:47+06:00","image":"http://localhost:1313/p/workspace-one-access-22.09-integration-with-horizon-on-premises/title_hu47f31a060c17741ed671fdc891fc1e2a_84440_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/workspace-one-access-22.09-integration-with-horizon-on-premises/","title":"Workspace ONE Access 22.09 – Integration with Horizon On-Premises"},{"content":"Hello everyone and welcome back to the Windows 365 full guide. This week we continue the guide with Image Management capabilities and what you need to take care of, when replacing the currently used image for your Cloud PCs.\nMainly I will focus on these topics:\nImage prerequisites for Windows 365 Image preperation Image replacement strategies Important notice # Image prerequisites for Windows 365 Windows 365 offers the possibility to import individual images for your Cloud PCs. But why does this makes sense, as we can use Microsoft Endpoint Manager to install apps and apply configurations on our persistent Desktops? Simply for the reason of generalization and streamlining the desktop experience for all users! Microsoft Endpoint Manager (covered in detail in the following chapter) should be used from my perspective for the overall management, but to deploying a master image with most prerequisites applied already should be mandatory for most organizations. To deploy images for Windows 365 there are some important prerequisites that you need to keep in mind prior to plan the image, as your Azure Virtual Desktop images (reyling on Windows 10 Enterprise Multi-Session) CANNOT be reused. Before you wrap up a new image on Microsoft Azure, ensure that your virtual machine fullfills the following requirements\nOS must be Windows 10 Enterprise (No Multi-Session) Images must be generalized prior to be used for WIndows 365 Virtual Machine generation must be GEN1 # Image preperation Now that we know the prerequisites we can start creating a new virtual machine on Azure. In this article, I will just show you how to prepare the virtual machine and how to generalize it. Customizations are depending on your organization and apps that you might want to deploy to your users and can’t be fully considered. However, I’ve written a guide with best practices, which can be downloaded here:\n# Create new image virtual machine on Azure As a first step, before installing all the required apps and set the configurations needed, we need to create a virtual machine from Azure as a starting point. First, we need to login to the Azure Portal and navigate Create a resource, alternatively go to Virtual Machines and click create.\nOnce you’ve clicked Create a resource you’re in the Azure Marketplace. Search for Windows 10 as a term and select Microsoft Windows 10 once available.\nNow you can select the version that you want to use for your Golden Image. In my case I choose to use Windows 10 Enterprise, Version 21H1. Make sure that you don’t select Windows 10 Enterprise Multi-Session versions as they cannot be used with Windows 365.\nSelect on Create to continue. Now you just need to fill out the required information, such as Resource Group, VM name, the region that you want to deploy as well as the size. For an image I use the recommended size or a Standard_D4ds_v4 or comparable. Set the local Admin password and the network preferences as you wish.\nThe most important thing, after providing the information is to switch to the Advanced tab in your virtual machine creation process and scroll down the page.\nBefore you continue, make sure Gen 1 is selected, otherwise your image wont be imported! Once you ensured the configuration is correctly set, navigate to the Review + create page and create the virtual machine.\nPerform customizations + Virtual Machine generalization Now that we’ve successfully deployed the virtual machine, you can continue to install your apps and configurations that need to be done.\nOnce this task is complete you need to generalize the virtual machine to be used for Windows 365. To do this, you must open the Windows Explorer and navigate to C:\\Windows\\System32\\Sysprep\nOpen the sysprep.exe, check the generalize box and select the Shutdown option (very important).\nOnce this is done and you initiate the generalization process. If you might encounter issues, make sure that you validate the installed AppX apps on the system as they can produce issues in the image creation process.\nCapture the virtual machine to become an Image for Windows 365 As a next step, we need to switch back to the Azure portal, where we’ll find the virtual machine in a stopped state. Select the virtual machine, and click on Stop in the top bar to also deallocate the machine.\nThe status of the VM will change to Stopped (Deallocated).\nThe next step is to click on Capture in the top bar, which brings us to the following menu:\nSelect the Resource Group, where you want to store our new image, define if you want to store the image inside of a Shared Image Gallery (recommended for production workloads and multiple images to maintain). In my case I’m doing this for a single image, so I select No, capture only a managed image and I provide a name, before continuing to Tags and to Review + create, where I finally create the image.\nKeep in mind that the virtual machine associated to that image is unusable after the creation!\nImporting the image to Windows 365 Finally, we’ve created our new image that we can now important to Windows 365 to be provisioned for our Cloud PCs. Please log into the Microsoft Endpoint Manager admin center using https://endpoint.microsoft.com. Select Devices and choose Windows 365 under Provisioning.\nIn the previous chapters we’ve seen how easy it is to create a new provisioning policy, now we will have a closer look at how to import the image, so we select Device images. The name can be quite confusing as the images will be used for virtual machines. Arrvied in the Device image tab, we click + Add to import our recently created Azure image. You might have seen some articles stating that you must import the image from a Hyper-V environment, which is not true, however it can be an option if you’re forced to prepare the image on-premises.\nOnce we’ve selected + Add, we can provide again some information like the Image name, the image version (e.g. 1.0.0) and pick the source image from the drop down list. Important, the image must be in the same Subscription associated to the On-Premises network connection we have created earlier.\nClick on Upload, once you’ve finished the editing process. The overall process took 60 minutes to complete, afterwards the image will be presented as follows:\n# Image replacement strategies After successfully creating and importing the image, I want to show the options to replace images and there are quite a few things you must consider before applying any new provisioning policy to your users or before you replace any images:\nCan you ensure that your users have their data backed up on OneDrive / SharePoint etc.? Can you ensure that no app critical data can get lost? (e.g. License files in the local user profile) Did you communicate the changes with your end users? Did you choose a good time to re-provision your desktops as this process can take up to 40 minutes? In general, it makes sense to import the image before deploying production Provisioning policies, however in case that you must re-provision desktops I personally went for the following strategy.\nFirst I switched to the Provisioning policies tab in the Windows 365 menu.\nInstead of creating a new policy, I select the one that I’ve already created (because I want to provision the updated image to my end users).\nIn the center screen we can click on edit to select the image / image version that we want to pick.\nSelect Custom Image as Image type from the drop down menu.\nNow you can select our recently created image / version from the right hand side menu.\nClick on Select and continue the process when clicking on Next. Then click Update on the final page to complete the update of the provisioning policy.\nBut what is the result from updating the policy? Actually nothing in the beginning, as the Cloud PCs require to be reprovisioned from Endpoint Manager. At the moment this is not done in bulk, but maybe there will be soon a possibility to.\nIf you want to continue, go back to the Microsoft Endpoint Manager admin center and select Devices \u0026gt; Windows and select one of your provisioned Cloud PCs that you want to equip with the new image. Once this is done, you just need to select Reprovision from the top bar of the selected Cloud PC. Click Yes to complete the task.\n# Important notice! ATTENTION, before you reprovision as it might have a huge impact on your user’s configuration and files as it will be reset to default values unless you have them backed up somewhere. I’m really looking forward to the FSLogix integration, as this will remediate exactly this issue.\n","date":"2022-12-25T16:56:47+06:00","image":"http://localhost:1313/p/windows-365-full-image-guide/title_hu47f31a060c17741ed671fdc891fc1e2a_79148_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/windows-365-full-image-guide/","title":"Windows 365 - Full Image Guide"},{"content":"Hi everyone,\ntoday I have another blog for you about how to distribute the Remote Desktop Client for Azure Virtual Desktop and the upcoming service release of Windows 365 Cloud PC. We will perform the distribution to your clients via Microsoft Endpoint Manager (Intune).\nThe first thing we need to do is to package our Remote Desktop Client in the current version: 1.2.2130\nPlease find the latest version here: What’s new in the Windows Desktop client | Microsoft Doc\nPackaging of the Remote Desktop Client app and upload to Microsoft Endpoint Manager (Intune)\nThe first thing we need to do now is to select the architecture, we use to distribute the client. In my case, I take the 64-bit client and download it to my computer.\nI’ve used the following download link for the 64-bit version: (https://go.microsoft.com/fwlink/?linkid=2139233)\nNow I copy the downloaded file to a location that is easily accessible from my packaging PC. For this reason, I create a new folder called: “RemoteDesktopClient_122130″ in my favorite location.\nIn the next step, we need to download the Microsoft Win32 Content Prep tool, to package our MSI file into an IntuneWin container.\nGo to the following GitHub page and download the exe: (https://web.archive.org/web/20230321230532/https://github.com/Microsoft/Microsoft-Win32-Content-Prep-Tool)\nFor this demonstration I’ve created a folder called “MEM” where I store the file.\nNow, we need to open a PowerShell window with elevated rights (Administrator) and set the Execution Policy to “RemoteSigned” and approve with “Y(es)”:\n1 Set-ExecutionPolicy RemoteSigned Next, we navigate to the folder, that has our IntuneWinAppUtil, which is in my example C:\\MEM. Do this using: Now we need to specify the Source file, which is our recently downloaded Remote Desktop Client and the destination location for the IntuneWin file. We start with opening the IntuneWinAppUtil.\n1 2 cd C:\\MEM .\\IntuneWinAppUtil.exe The tool asks us to specify the source folder, we select the one where our Remote Desktop Client is stored, give the tool the file name and select the output folder. We don’t want to specify a catalog folder.\nWe can see the intunewin file besides the MSI file.\n# Import Remote Desktop Manager via MEM (Intune) To import the package to Intune, we need to login first to our tenant using: (https://endpoint.microsoft.com)\nNow we need to navigate to Apps / Windows\nNow we see the collection of all Windows apps available and we click on “+Add” to import our Remote Desktop Client.\nNow we need to select the App type, which is “Windows app (Win32)” and click on select.\nThe process asks us now for the app package file, which is the intunewin file we’ve just created.\nOnce everything is fine, we click on OK and specify the parameters for the installer. In my case I only had to add the Publisher information to the package. I specified “Microsoft” and click on next.\nThe advantage of using an MSI is that the IntuneAppWinUtil automatically detects the installation parameters, additional ones can be added, but that’s not required and we can continue with the next steps.\nIn the next tab, we need to provide the requirements, which is obviously the 64-bit architecture and the minimum operating system (that can be adjusted to your environment), which is Windows 10 1909 in my case. We click next, once finished.\nThe next step requires us to define a detection policy, we click on “+Add” and specify the MSI product code option, as this is already prefilled.\nFor the next steps we don’t define dependencies, supersedence and we can continue to select the Scope Tags and do the assignment if needed. In my case I select a Windows 11 based laptop that is completely Azure AD joined. I define to install the app asap with no user interaction (so Toast notifications wont appear).\nLast but not least we validate the configuration and apply it.\n# Configure auto feed discovery for the Remote Desktop Client app (MEM and GPO) Now we want that our users don’t need to log into the Remote Desktop Client with their user credentials. For this reason, we can define a configuration policy in Intune, which helps us to improve the user experience.\nNow that the Remote Desktop App is prepared, we need to navigate to Devices \u0026gt; Configuration policies in Intune and create a new profile.\nSelect “Windows 10 and later” as a platform and the profile type as “Settings catalog (preview)“.\nWe name our policy “Remote Desktop Client Auto Feed Registration” and click on next.\nNow we click on “+Add settings” and type “remote desktop” in the search bar. Scroll down to “Administrative Templates / Windows Components / Remote Desktop Services / Remote App and Desktop Connections”\nCheck the box for “Specify default connection URL (User)“. Back in the settings, switch the toggle to “Enabled” and specify the “Default connection URL” as: https://rdweb.wvd.microsoft.com/api/arm/feeddiscovery\nIMPORTANT! Keep in mind that this setting is currently only available for Windows Insiders! For all other use cases you can use the corresponding Group Policy Setting in your on-premises environment to configure the auto configuration.\nThe last step is to select the users/groups you want to assign this policy to and create it!\nAnd that’s it – a super-easy way of packaging and deploying as well as auto-configuring the Remote Desktop Client for accessing your remote computing resources from the Microsoft Cloud!\nIf you have any questions, feel free to reach out in the comments or on Social Media, I’m always happy to help!\nCheers,\nPatrick\n","date":"2021-07-29T16:56:47+06:00","image":"http://localhost:1313/p/distribute-and-configure-the-remote-desktop-app-via-intune/title_hu47f31a060c17741ed671fdc891fc1e2a_105712_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/distribute-and-configure-the-remote-desktop-app-via-intune/","title":"Distribute and Configure the Remote Desktop app via Intune"},{"content":"This announcement of Eva Seydl, Program Manager at Microsoft, made my week! Start VM on Connect, a feature well known to most of the WVD rockstars as a solution to start virtual machines in Personal Host Pool scenarios is now also available for Pooled Host Pools.\nIn this blog you will learn, how to configure Start VM on Connect for Pooled Host Pools, Personal Host Pools and how to shut down VMs, when the users are logging off.\n# Prerequisites If you want to get started with Start VM on Connect in general you need to know a few things about it. It’s a feature that allows you to start virtual machines, but not yet to stop and deallocate them!\nAdditionally, it’s important to mention, that the feature supports ony the following Remote Desktop Clients:\nThe WVD web client: (https://rdweb.wvd.microsoft.com/arm/webclient) The Windows client (from version: 1.2748 or later) – Connect to Windows Virtual Desktop Windows 10 or 7 – Azure | Microsoft Docs Android client (from version 10.0.10 or later) – (https://play.google.com/store/apps/details?id=com.microsoft.rdc.androidx) macOS client (from version 10.6.4 or later) – (https://apps.apple.com/app/microsoft-remote-desktop/id1295203466?mt=12) The iOS client is currently NOT supported! Updates can happen at any time to change this.\nTo make the feature work in your environment, the second prerequisite is to create a custom role for Start VM on Connect. This can be achieved by granting access to the following set of permissions:\nMicrosoft.Compute/virtualMachines/start/action Microsoft.Compute/virtualMachines/read # How to create the custom role First, you have to open your subscription from the Azure Portal. Click on Access control (IAM) to create a custom role.\nIn the top center of the screen click on “+Add” to create the new role and select “Add custom role”.\nNow you have to give your role a name. I’ve chosen: “WVD Start VM on Connect”, which allows me to identify the role I need easily. Give your new role a description to understand easily, what this role is for, and click on Permissions.\nNow click on “+Add permissions” and select the permissions you want to grant for this role. Like mentioned above you need:\nMicrosoft.Compute/virtualMachines/start/action Microsoft.Compute/virtualMachines/read Alternatively, import the following JSON file for your role:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 { \u0026#34;properties\u0026#34;: { \u0026#34;roleName\u0026#34;: \u0026#34;WVDStartVMonConnect\u0026#34;, \u0026#34;description\u0026#34;: \u0026#34;Custom role for starting VMs for WVD\u0026#34;, \u0026#34;assignableScopes\u0026#34;: [ \u0026#34;/subscriptions/4faae4e2-2c28-4b36-9002-31ad17a4ded4\u0026#34; ], \u0026#34;permissions\u0026#34;: [ { \u0026#34;actions\u0026#34;: [ \u0026#34;Microsoft.Compute/virtualMachines/read\u0026#34;, \u0026#34;Microsoft.Compute/virtualMachines/start/action\u0026#34; ], \u0026#34;notActions\u0026#34;: [], \u0026#34;dataActions\u0026#34;: [], \u0026#34;notDataActions\u0026#34;: [] } ] } } Now, click Review + create and confirm another time by clicking “create“.\nOnce the task is completed, you will get the following notification.\nAs the role is created, you need to assign this custom role to the WVD service. This can be achieved by clicking on “Role assignments” in your subscription, followed by clicking “+Add” \u0026gt; “Add role assignment“.\nNow you just need to pick the recently created role, which is WVDStartVMOnConnect in my case, and assign access to Windows Virtual Desktop as a service. Once this is done, the role assignment completed successfully.\n# Enable “Start VM on Connect for Pooled Host Pools“ On 12 May, Eva Seydl, Program Manager at Microsoft announced the availability of Start VM on Connect for Pooled Host Pools! This is awesome news, because it allows the first user connecting to a turned off Session Host to turn it on an allows an even more flexible way of scaling. Additionally, it allows you to scale down your Virtual Machines to ZERO, which is a huge cost saving opportunity for your environments.\nThe following describes the way to configure Start VM on Connect for Pooled Host Pools.\nThe important thing you need to know is, that this feature is currently in Preview. For that reason there is no graphical button to turn this feature on and it actually requires PowerShell.\nNow log on to your Azure account with administrative privileges for WVD. Additionally make sure you have the Az.DesktopVirtualization module installed.\n1 2 Connect-AzAccount Import-Module Az.DesktopVirtualization Now you need to identify the Pooled Host Pools in your environment, you can achieve this by the following line of code:\n1 Get-AzWvdHostPool | Where-Object {$_.HostPoolType -eq \u0026#34;Pooled\u0026#34;} # Turn on the feature for a single pooled HostPool 1 Update-AzWvdHostPool -ResourceGroupName \u0026lt;resourcegroupname\u0026gt; -Name \u0026lt;hostpoolname\u0026gt; -StartVMOnConnect:$true # Turn on the feature for ALL pooled HostPools Information: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (https://web.archive.org/web/20230326143059/https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 Connect-AzAccount $AllHostPools = Get-AzResource | Where-Object ResourceType -eq Microsoft.DesktopVirtualization/hostpools foreach ($HostPool in $AllHostPools) { $HostPoolValidation = Get-AzWVDHostPool -Name $HostPool.Name -ResourceGroupName $HostPool.ResourceGroupName if ($HostPoolValidation.HostPoolType -eq \u0026#34;Pooled\u0026#34;) { if ($HostPoolValidation.StartVMOnConnect -eq $true) { Write-Host \u0026#34;The HostPool \u0026#34;$HostPoolValidation.Name\u0026#34; has the feature already enabled. Continue with the next one\u0026#34; } else { Update-AzWvdHostPool -Name $HostPool.Name -ResourceGroup $HostPool.ResourceGroupName -StartVMOnConnect:$true Write-Host \u0026#34;Start VM on Connect has been successfully configured for Host Pool \u0026#34;$HostPoolValidation.Name\u0026#34;\u0026#34; -ForegroundColor Green } } else { } } # Turn off the feature for a single Pooled HostPool 1 Update-AzWvdHostPool -ResourceGroupName \u0026lt;resourcegroupname\u0026gt; -Name \u0026lt;hostpoolname\u0026gt; -StartVMOnConnect:$false # Turn off the feature for all Pooled HostPools 1 2 3 4 5 6 7 8 9 10 11 12 13 14 Connect-AzAccount $AllHostPools = Get-AzResource | Where-Object ResourceType -eq Microsoft.DesktopVirtualization/hostpools foreach ($HostPool in $AllHostPools) { $HostPoolValidation = Get-AzWVDHostPool -Name $HostPool.Name -ResourceGroupName $HostPool.ResourceGroupName if ($HostPoolValidation.HostPoolType -eq \u0026#34;Pooled\u0026#34;) { if ($HostPoolValidation.StartVMOnConnect -eq $false) { Write-Host \u0026#34;The HostPool \u0026#34;$HostPoolValidation.Name\u0026#34; has the feature already enabled. Continue with the next one\u0026#34; } else { Update-AzWvdHostPool -Name $HostPool.Name -ResourceGroup $HostPool.ResourceGroupName -StartVMOnConnect:$false Write-Host \u0026#34;Start VM on Connect has been successfully deactivated for Host Pool \u0026#34;$HostPoolValidation.Name\u0026#34;\u0026#34; -ForegroundColor Green } } else { } } # Enable “Start VM on Connect for Personal Host Pools“ If you want to enable Start VM on Connect for Personal Host Pools, that’s also not a problem and can easily be achieved by using the Azure Portal. If you wish to do this by PowerShell, this can also be achieved and will be explained in the following subchapters.\n# Enable the feature for a single Personal Host Pool (Azure Portal) The easiest possibility of managing the Start VM on Connect feature is currently (last reviewed 18.05.2021) the Azure Portal. Where it’s not possible to achieve this for Pooled Host Pools, the Microsoft Product Group enabled this feature already for the Personal Host Pools.\nAll you need to do is to log into the Azure Portal using: https://portal.azure.com and navigate to the Windows Virtual Desktop Service. Arrived in the Host Pool overview, you will find the Pooled and Personal Host Pool types. We select the Personal Host Pool we want to enable to continue. Now we need to select Properties to find this option.\nAs a last step, you only need to enable the “Start VM on Connect” feature, while hitting Yes and clicking on “Save” in the upper corner. That’s it!\n# Enable the feature for all Personal Host Pools (PowerShell) If you want to enable the feature for all Personal Host Pools, we need to use the PowerShell again. Please use the following script to allow all Personal Host Pools for Start VM on Connect.\nInformation: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 Connect-AzAccount $AllHostPools = Get-AzResource | Where-Object ResourceType -eq Microsoft.DesktopVirtualization/hostpools foreach ($HostPool in $AllHostPools) { $HostPoolValidation = Get-AzWVDHostPool -Name $HostPool.Name -ResourceGroupName $HostPool.ResourceGroupName if ($HostPoolValidation.HostPoolType -eq \u0026#34;Personal\u0026#34;) { if ($HostPoolValidation.StartVMOnConnect -eq $true) { Write-Host \u0026#34;The HostPool \u0026#34;$HostPoolValidation.Name\u0026#34; has the feature already enabled. Continue with the next one\u0026#34; } else { Update-AzWvdHostPool -Name $HostPool.Name -ResourceGroup $HostPool.ResourceGroupName -StartVMOnConnect:$true Write-Host \u0026#34;Start VM on Connect has been successfully configured for Host Pool \u0026#34;$HostPoolValidation.Name\u0026#34;\u0026#34; -ForegroundColor Green } } else { } } # Disable the feature for Personal Host Pools (Azure Portal) Disabling the feature for a single Personal Host Pool, is as simple as enabling it. Just follow the steps from the previous subchapter and select “No” in the option field from within the Host Pool property page.\n# Disable the feature for all Personal Host Pools (PowerShell) If you want to disable the feature for all Personal Host Pools, please use the following script. Information: Make sure you’re in the correct AZ Context in case you’re handling multiple subscriptions in your environment. Usage and more information can be found here: (https://docs.microsoft.com/en-us/powershell/module/az.accounts/set-azcontext?view=azps-5.9.0#syntax)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 Connect-AzAccount $AllHostPools = Get-AzResource | Where-Object ResourceType -eq Microsoft.DesktopVirtualization/hostpools foreach ($HostPool in $AllHostPools) { $HostPoolValidation = Get-AzWVDHostPool -Name $HostPool.Name -ResourceGroupName $HostPool.ResourceGroupName if ($HostPoolValidation.HostPoolType -eq \u0026#34;Personal\u0026#34;) { if ($HostPoolValidation.StartVMOnConnect -eq $false) { Write-Host \u0026#34;The HostPool \u0026#34;$HostPoolValidation.Name\u0026#34; has the feature already enabled. Continue with the next one\u0026#34; } else { Update-AzWvdHostPool -Name $HostPool.Name -ResourceGroup $HostPool.ResourceGroupName -StartVMOnConnect:$false Write-Host \u0026#34;Start VM on Connect has been successfully deactivated for Host Pool \u0026#34;$HostPoolValidation.Name\u0026#34;\u0026#34; -ForegroundColor Green } } else { } } # Enable “Shutdown virtual machines at LogOff“ A few weeks ago, Microsoft Global Black Belt Bernd Löhlein blogged about shutting down the Session Hosts and deallocating them, to not consume more money from your subscription, when the users log off. The solution is great for Personal Host Pools, but shouldn’t be used with Pooled Host Pools, as there might be more people working on the Session Host concurrently. Please find Bernd’s blog here: (https://techcommunity.microsoft.com/t5/windows-virtual-desktop/deallocate-vm-on-user-logoff/m-p/2280211)\n# Shutting down Pooled Session Hosts To achieve this we have two possibilities:\nShutting down the virtual machines based on a time based metric Using the WVDLogix Autoscale Tool to scale down machines To shut down the VMs based on a time based metric, we need to create an Automation Account in our subscription.\nOn the next page, we´ll give our Automation Account a name, select the subscription, the RG we´ve created, and the operating location, which is West Europe in my case. You also have the possibility to create a RunAs Account, which is not needed for the solution, which we´re going to provision right afterwards. Hit “Create” once you´re finished.\nAfter a few seconds, our storage account is ready to be used and we can go to the resource, which presents us the basic overview of an Automation account.\nIn here, we need to scroll down on the left hend side until we reach “Start/Stop VM”, which is the solution we want to install.\nIt´s obvious that we´re going to click on “Create”, but I´m very excited to see, what you´re saying about what this solution delivers additionally, when correctly configured. For now we click “Create” again to provision the solution.\nThe agent will guide us through the deployment of the solution, which requires the following components:\nLog Analytics Workspace (Can be created from within the solution deployment) Azure Automation Account (which has been created previously) Parameters After you´ve created the Log Analytics Workspace and select the Automation Account created by us earlier, we leave the parameters empty for the moment. To not hide the possibilities from you, here is the screenshot of the initial configuration, to be defined from over here already.\nAs mentioned before, we keep it empty and hit “OK” and click “Create”.\nThe deployment process is going to start and will finalize between 10-15 minutes and this will shutdown all machines, based on a time based metric automatically.\nMy personal recommendation is clearly to use the Autoscaling engine! Thank you for reading this article!\nCheers, Patrick\n","date":"2021-07-29T16:56:47+06:00","image":"http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/title_hu47f31a060c17741ed671fdc891fc1e2a_106079_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/start-vm-on-connect-for-pooled-and-personal-host-pools-in-wvd/","title":"Start VM on Connect for Pooled and Personal Host Pools in WVD"},{"content":"A feature that came with the latest Windows Update is the “News and Interests” taskbar widget for Windows 10. A feature that might make sense for the user experience on stationary PC’s is definetly something that can confuse users in multi-session environments – like such on Azure Virtual Desktop.\nHow you can easily turn this feature off is what we’re covering in today’s blog post!\n# Turn off the feature via Group Policy / Registry The easiest way I would recommend deactivating the features for all users is via Group Policy. As there is currently no official option to turn this feature off, you can achieve this by using a registry key.\nNavigate to the Group Policy Management console on your Active Directory server and create a new Registry Key for your Session Hosts:\n1 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Feeds Create a new entry:\n1 2 3 Type: DWORD Name: ShellFeedsTaskbarViewMode Value: 2 IMPORTANT! Value “2” deactivates the feature in the next couple of minutes from the virtual machine. If the value is set to “0”, the feature remains enabled!\nThat’s it! With that trick you can deactivate the widget easily.\nNevertheless I would be interested to know your opinion about the feature! Do you any sense in keeping it enabled on multi-session VMs? Let me know!\nCheers, Patrick\n","date":"2021-07-29T16:56:47+06:00","image":"http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/title_hu47f31a060c17741ed671fdc891fc1e2a_102445_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/turn-off-news-and-interests-taskbar-widget-for-windows-10-enterprise-multi-session/","title":"Turn off “News and Interests” taskbar widget for Windows 10 Enterprise Multi-Session"},{"content":"Hi everyone it´s Patrick again with a new article on the RDP properties in Windows Virtual Desktop.\nAs some of you know, these popped up on the 5th October 2020 again, after a few months of disappearance. Some of you had a lot of questions, especially on the impact these settings have.\nThe purpose of this article is to give you a general overview of the settings and their impact on the Remote Desktop itself.\nIf you want to get a general overview of the new RDP settings, please watch the video below and use this guide to help you rock your AVD environment:\n# Where to define RDP properties First of all you can define RDP properties from within the Azure Portal. To find them, simply logon to the Azure Portal on https://portal.azure.com and navigate to the Windows Virtual Desktop service by using the search bar or using the quick link. To find the properties you must have at least one Host Pool in place. This can be created from within the portal or via PowerShell.\nSelect one of the Host Pools, in my example this is “KCLD-WVD-TestAuto”\nFinally click in the menu on the left side on RDP properties to see the options.\nYou can also define RDP properties via Powershell. Same here, a Host Pool must be present in the current setup.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 ### Variables - Please replace Resource Group and HostPool with your values ### $RGHP = %Your Resource group for HostPools% $HPName = %Your HostPool name% ### Install new Spring Release Powershell Module for WVD ### Install-Module Az.DesktopVirtualization ### Import Module ### Import-Module Az.DesktopVirtualization ### Login to Azure Account ### Connect-AzAccount ### Retrieve current settings from HostPool ### Get-AzWvdHostPool -ResourceGroupName $RGHP -Name $HPName | fl Name,CustomRDPProperty # Connection information The connection information tab is the first of five to define the RDP properties for the Host Pool. Let me quickly explain you the different values:\nCredential Security Support Provider (CredSSP): Identifies whether Remote Desktop will use CredSSP for authentication if it´s available.\nFor those of you, which doesn´t know what CredSSP is, it can be generally explained as Security Provider that will be used by the Support provider Interface. It helps an application “Remote Desktop Client” e.g. to delegate the user´s credentials from the client to the target server for remote authentication.\nManual setting value: enablecredsspsupport:i:value\nReconnection settings: This setting helps administrators to let their users reconnect to their existing session if the session reaches the state disconnected. This can happen when a user logs off or is just closing the window. If you want your users to get a new session, select “initiate a new connection”.\nManual setting value: disableconnectionsharing:i:value\nPractical Tip! If you select the initiate a new connection setting, make sure the user will be properly logged off after a certain time limit has reached. Otherwise, the users will flood your environment with multiple logins which make an Auto Scaling logic impossible to apply! This can be reached by applying the Group Policy to enforce the logoff by determining a specific time limit:\n1 Computer Configuration / Administrative Templates / Windows Components / Remote Desktop Services / Remote Desktop Session Host / Session Time Limits This is a general tip, regardless of the RDP setting mentioned, it will help your users to properly logoff as well and to avoid issues with the FSLogix profile.\nAlternate Shell (Path): This setting defines a program to be started automatically ones a new user session has been initiated. It makes sense if you want to enforce a user to use a specific app at the start-up without linking an app to the user´s start-up folder. The path to that application must be defined as local path “C:\\ProgramFiles\\Office\\word.exe” e.g..\nManual setting value: alternate shell:s:value\n# Session behaviour Reconnection: Defines, if a client should try to reconnect to a user´s session if the connection gets lost. This can happen when the internet connection is lost, or if there a any other unforeseeable reasons on a network level. You can choose whether you want to PREVENT or ALLOW a client to re-establish a connection.\nRecommended: Client automatically tries to reconnect.\nManual setting value: autoreconnection enabled:i:value\nBandwidth auto detect: Determines whether automatic network type detection is enabled or disabled. It helps to identify the currently available bandwidth. This setting correlates with the next setting “Network Auto Detect”\nRecommended: Enable automatic network type detection\nManual setting value: bandwidthautodetect:i:value\nNetwork auto detect: Determines whether to use automatic network bandwidth detection or not. Requires the previous option to be set. Attention: Connection type 7 is required.\nGenerally, these settings can be defined as well in a RDP file. We distinguish between the following modes on-premises:\n1 – Modem (56 Kbps). 2 – Low-speed broadband (256 Kbps – 2 Mbps). 3 – Satellite (2 Mbps – 16 Mbps with high latency). 4 – High-speed broadband (2 Mbps – 10 Mbps). 5 – WAN (10 Mbps or higher with high latency). 6 – LAN (10 Mbps or higher). 7 – Automatic bandwidth detection – REQUIRES bandwidthautodetect\nThe setting itself, doesn´t do anything, when set. It becomes active, when select in the RDC GUI and changes automatically several performance related settings such as: Themes, Font Smoothing, Aminations etc.\nRecommended: Use automatic network bandwidth detection.\nManual setting value: networkautodetect:i:value\nCompression: Determines whether bulk compression is enabled when it is transmitted by RDP to the local computer.\nThis setting was first introduced in the RDP6 protocol and has helped in reducing the RDP network bandwidth significantly. In some cases you might want to disable this setting, as there are already mechanisms by your network vendors (e.g. Cisco Wide Area Application Services), where compression occurs problems. This must be identified together with your networking team.\nRecommendation: Enable RDP bulk compression.\nManual setting value: compression:i:value\nVideo playback: Determines if the connection will use RDP-efficient multimedia streaming for video playback.\nThis setting has been first introduced in July 2009, where improvements have been made to optimize the overall video playback experience for Win7 and Win2008 R2 servers. Technically it means, that the client (endpoint) will receive the original compressed multimedia stream from the RDP server / WVD Session Host and decode it on the local hardware for displaying. This is also an improvement of the network bandwidth, as the data will be received compressed on the endpoint.\nRecommendation: Use RDP-efficient multimedia streaming for video playback when possible.\nManual setting value: videoplaybackmode:i:value\n# Device redirection Microphone redirection: Lets you decide if you want to redirect audio capturing devices from you local endpoint to the remote session. Required for video conferencing tools as Webcams with Mics and other microphones will not work.\nRecommendation: Enable audio capture from the local device and redirection to an audio application in the remote session\nManual setting value: audiocapturemode:i:value\nRedirect video encoding: Enables or disables the video encoding on the local endpoint for the RDP session.\nRecommendation: Enable encoding of redirected video.\nManual setting value: encode redirected video capture:i:value\nEncoded video quality: Helps to define how much a video will be compressed for the remote session. You have the following options with the impacts:\nManual setting value: encode redirected video capture encoding quality:i:value\nAudio output location: Defines, where audio will be played while being connected to the remote session. You can decide between the following options:\nRecommendation: Play sounds on the local computer\nManual setting value: audiomode:i:value\nCamera redirection: Helps to define, if cameras / webcams can be redirected to the remote session from the local endpoint. You can redirect all cameras, or define manually a list of cameras to be redirected. Important! The redirection of the camera is mandatory for the usage of video conferencing tools such as Teams.\nRecommendation (simplified): Redirect cameras.\nManual setting value: camerastoredirect:s:value\nUSB device redirection: Helps to define, if and which USB devices shall be redirected to the remote session host from the local endpoint. You can define, whether you want to decline any redirected USB devices, redirect all supported drives including later connected ones or to manually enter the list of USB devices while using the hardware ID.\nRecommendation (simplified): Redirect all USB drives Attention! Redirecting all USB drives is just a very simplified option! For security I don´t recommend this setting as any foreign USB key with potential malware on it can be plugged and being redirected to the remote session. Please evaluate this setting from case to case!\nManual setting value: devicestoredirect:s:value\nDrive/storage redirection: Determines, which local drives shall be redirected to the remote session. The following options are available:\nThe options are nearly self-explaining. You can decide to redirect all drives, also those attached at a later time. You allow only drives, connected after the remote session has been established, or you define manually the drives and labels to be redirected.\nRecommendation: Depends on the security needs! Be aware that redirecting all drives is a potential security risk for your environment.\nIf you want to manually allow the redirection, you can define this by defining the drive letter e.g.:\nManual setting value: drivestoredirect:s:value\nClipboard redirection: Determines if the local clipboard from the local endpoint shall be redirected to the remote session. You can define if you want to allow it or block it.\nRecommendation: Depends on the security you want to provide. If somebody writes her / his password in cleartext in a text field and just copies it, it could be potentially captured. Be cautious!\nManual setting value: redirectclipboard:i:value\nCOM ports redirection: Determines if you want to redirect serial connections from your local endpoint to the remote session. Might be useable for legacy devices.\nRecommendations: COM ports are not available in the remote session. Depends on the case.\nManual setting value: redirectcomports:i:value\nPrinter redirection: This setting lets the local printers being redirected to the remote session from the local endpoint. This might be helpful for your end-users in home office scenarios, where printing is essential. You can decide whether you want to allow or decline the connection.\nRecommendation: Depends on the security. Printing out confidential documents might be a potential risk. This can also be protected by Windows security mechanisms like Information Protection, but if those features are not in place, printing could be declined.\nManual setting value: redirectprinters:i:value\nSmart card redirection: Determines, whether you want to allow Smartcard redirection or not. Smartcards generally help to authenticate against a specific service. This can be useful especially for Middleware’s connecting to financial software, or the local authentication on the Session host.\nRecommendation: The smart card device on the local computer is available in the remote session.\nManual setting value: redirectsmartcards:i:value\nUSB redirection: Helps to define more granularly, which kind and type of USB device shall be redirected to the remote session. Compared to the other settings above, you can decide to allow or decline the following settings:\nManual setting value: usbdevicestoredirect:s:value\n# Display settings Multiple displays: Determines if the remote session supports all displays or just a single display. If Enabled, you can select, whether all monitors should be used by default, or if you want to enter a list of display IDs to allow only these monitors. Additionally, you can define the maximizing behavior for these screens, as well as a Multi to single display switch, which helps to switch from a multi-screen to single screen, when the full screen mode has been ended.\nRecommendation: Enable multiple display support\nManual setting value: use multimon:i:value\nScreen mode: Determines whether the remote session will appear in a windowed or full screen mode.\nRecommendation: The remote session will appear full screen.\nManual setting value: screen mode id:i:value\nSmart sizing: Helps to scale the remote content in the remote session to fit to the size of the monitor. This will automatically adapt the resolution on the remote host. You can decide if you want to allow the scaling in case of resizing or not.\nRecommendation: The local window content will scale when resized.\nManual setting value: smart sizing:i:value\nDynamic resolution: Will define if the remote resolution will be adopted automatically, when sizing occurs. You can define if you want to keep the same resolution even if the size changes, or you can select a resolution update to the local windows resize and define the scaling factors:\nRecommendation: Session resolution updates as the local window resizes.\nManual setting value: dynamic resolution:i:value desktop size id:i:value | desktopheight:i:value | desktopwidth:i:value | desktopscalefactor:i:value\n# Advanced The advanced tab represents the option previously available, where you can define all the settings mentioned above while using the parameters.\nAll available parameters are available from the official Microsoft page, (https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/clients/rdp-files?context=/azure/virtual-desktop/context/context), or from the setting explanations above. To easily migrate these settings, just copy and paste the defined settings from the advanced settings once defined and paste them to another Host Pool if needed.\n# Conclusion I hope this article will help you to understand all of the available options for Windows Virtual Desktop more in depth and are a good guidance for your decision. Keep in mind, that the settings might change over time and that all of my recommendations are based on simple environments. Organizations with advanced security requirements, should consider using the manual way of allowing certain device redirection features, over allowing all devices automatically being redirected.\nIf you like my article, please share it, recommend it or leave a reply below!\nLooking forward to hear from you! Cheers,\nPatrick\n","date":"2021-07-27T16:56:47+06:00","image":"http://localhost:1313/p/azure-virtual-desktop-the-complete-rdp-property-guide/title_hu47f31a060c17741ed671fdc891fc1e2a_95454_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/azure-virtual-desktop-the-complete-rdp-property-guide/","title":"Azure Virtual Desktop - The complete RDP Property guide"},{"content":"Hi and welcome to my latest blog post about Azure Virtual Desktop and FSLogix v2105.\nOn the 12th of July, Microsoft announced a new version of FSLogix, which has a bunch of features, that could help you in maintaining your profiles. In this blog post, we will focus on: “How to increase the vhd/vhdx profile size” without the need for PowerShell or any migration of profile data into a new container.\nBut let’s start with a question that I previously get to show you the real advantage of this new capability.\n# What is the default size, and is that not enough for most use cases? As many of you know, an FSLogix default profile has a maximum size of 30GB per profile disk. For most use cases this should be absolutely sufficient, however, there are quite a few examples, where this isn’t enough (Hotline / HelpDesk workers with a lot of data that needs to be available in the profile and where OneDrive isn’t an option).\nSo you had two options:\nConsider a right sizing from the beginning and configure the SizeInMB registry / GPO setting accordingly Migrate the files to a container with an increased size and migrate the data properly and set the permissions As you can imagine, both options aren’t really optimal from the administration’s perspective.\n# How to I increase the FSLogix Profile size using version 2105? First, you need to perform the update to version 2105 from your current version. This can easily be achieved by downloading the installer files from Microsoft here.\nYou just need to install the application and restart the system to apply the update.\nAttention! Ensure that no users are logged on the system, while you’re performing the update to avoid data loss. Also, try to not log on with a user, that owns an FSLogix profile otherwise, you risk that your profile is corrupted. Now you need to follow these easy steps to achieve the profile increasing:\nConnect to your available Domain Controller, where you’re using the FSLogix Administrative Templates (available from the download link above) Navigate to the Group Policy Management mmc. Create a new Group Policy Object or navigate to your existing one (shown in my example below) Perform a right click and click on “Edit” Navigate to “Computer Configuration / Administrative Templates / FSLogix / Profile Containers“ Adjust the setting “Size in MBs” and set it to your preferred value. The increasing of the profile disk will become active, once the user logs on again. Once the user logged in, you can verify the change while navigating in your Windows Explorer to: “C:\\Program Files\\FSLogix\\Apps” and open the frxtray.exe to see the current status of the profile. Make a double click on the green light, which opens the tool to verify the new maximum profile size. As you can see the new profile size has directly been applied. If I’m not able to upgrade to v2105, how do I increase the profile size with option 2 mentioned above? If you still need to perform the increasing of the profile disk manually, you have to follow these steps:\nConnect to a session host / virtual machine that has the FSLogix Apps installed Navigate to: “C:\\Program Files\\FSLogix\\Apps” Collect the actual disk file of the profile that you want to increase. In my example this is a profile located on a storage account, that I’ve mounted using drive letter “Z”. E.g. Z:\\sstrange\\sstrange.vhdx IMPORTANT! Make sure to create a backup of the disk to avoid any corruption that could occur! Use the following command to increase the size from 30GB to 35GB: 1 .\\frx.exe migrate-vhd -src Z:\\sstrange\\Profile_sstrange.vhdx -dest Z:\\sstrange\\Profile_sstrange_increased.vhdx -size-mbs=35840 -dynamic=1 ATTENTION! If you might see an error coming up while migrating/increasing the user’s profile that sounds like: 1 Error Mirroring files (0x0000001D): The system cannot write to the specified device. This is most likely due to cache files that couldn’t be copied to the new disk files (most likely coming from Microsoft Edge cache). You can ignore this error for now and continue with the next step.\nNow you need to rename the profile, now that you have the previous and the new one. This means that you would need to rename Profile_sstrange.vhdx to Profile_sstrange_old.vhdx and Profile_sstrange_increased.vhdx to Profile_sstrange.vhdx. (Apply to your current naming settings defined in FSLogix). The result could look like this: Now keep the old profile and advise the user to perform a login test before removing the old profile. Once the user logged in, you can verify the change while navigating in your Windows Explorer to: “C:\\Program Files\\FSLogix\\Apps” and open the frxtray.exe to see the current status of the profile. Make a double click on the green light, which opens the tool to verify the new maximum profile size. As you can see the new profile size has directly been applied. As you have seen, the new version 2105 with the capability of increasing the profile disk size will help customers a lot. It’s a very streamlined administrative experience that does exactly what it should. The results can be verified and work perfectly with FSLogix Cloud Cache as well!\nI can just recommend performing the task via Group Policy if you want to apply the setting at a global scale, rather than doing it via Group Policy.\nNevertheless, there is one remark I want to make in terms of implementing this change. Keep in mind that all users, that have the right to use an FSLogix profile will be targeted with this setting, which leads into problems with your current allocated storage capacity! Make sure to keep your scoping right, or perform the manual way of doing it as stated in chapter “If I’m not able to upgrade to v2105, how do I increase the profile size with option 2 mentioned above?” if that fix should be applied to only a single / bunch of users.\nIf you have any questions, write them down in the comments and I will try to answer them asap!\n","date":"2021-07-27T16:56:47+06:00","image":"http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/title_hu47f31a060c17741ed671fdc891fc1e2a_73748_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/fslogix-v2105-how-to-increase-vhdx-size-of-profile-container/","title":"FSLogix v2105 – How to Increase VHDX size of profile container"},{"content":"Welcome to this very quick blog post about a topic that you may have experienced while enabling customers to use Azure Virtual Desktop. You installed the latest version on a computer and everything works fine, until the Remote Desktop app starts to crash frequently, or connections aren’t possible anymore. In some rare cases, you can’t even click anywhere.\nFor that reason, you can reset the Remote Desktop Client on Windows easily via PowerShell.\nThe feature is available from version 1.2.790, which has been released already in 2020.\nJust run this small line of code and you’ll be fine again:\n1 2 cd \u0026#34;C:\\Program Files\\Remote Desktop\\\u0026#34; .\\msrdcw.exe /reset /f I hope this helps in case that you encounter that kind of issue one day.\nCheers, Patrick\n","date":"2021-06-14T16:56:47+06:00","image":"http://localhost:1313/p/how-to-reset-the-remote-desktop-client-on-windows-10-11/title_hu47f31a060c17741ed671fdc891fc1e2a_72005_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/how-to-reset-the-remote-desktop-client-on-windows-10-11/","title":"How to reset the Remote Desktop Client on Windows 10 \u0026 11"},{"content":"On 16.04.2021 Tom Hickling (https://twitter.com/@tomhickling) announced via LinkedIn, that Microsoft released a tool to validate that Session Hosts can reach the required services to ensure full connectivity to the WVD services.\nThe tool is built to present you the URLs which are accessible or not, if that’s the case. However there are a few things you need to keep in mind, before running the tool.\nIn this blog, I will tell you what you must know about the URLs and ports to be opened for WVD, as well as what the required URL check tool can do for not and what it can’t do!\n# Which URLs and ports are required for a Session Host to connect to the WVD backplane? Let’s start with the first question on which URLs and ports you need to open to let your Session Hosts access the WVD backplane. You will see a few URLs with an asterisk (*), or a wildcard in front of the URL, you have to know that the WVD required URL check tool is NOT able to resolve or check against those, so you have to ensure proper connectivity.\n# Is there an easier way to enable the required ports if I’m using Azure Firewall? In case that you’re using Azure Firewall you’re lucky, because Microsoft provides FQDN Tags for Windows Virtual Desktop, which enables the service in just a few clicks. So you don’t need to open the ports / URLs one by one, as you can simply select the service Tag “Windows Virtual Desktop”.\nJust navigate to your Azure Firewall and select a Firewall Policy. Here you can find “Application Rules“, create a new rule, and select the IP address range of your WVD Session Hosts or any by typing “*” and select “Destination Type” FQDN Tag. Now you can simply select “WindowsVirtualDesktop” from the dropdown list and click save until you’re ready to go.\n# What are the requirements for the WVD required URLs check tool WVD Host Pool with deployed Session Hosts (as this script/tool is intended to run from inside the VM) .NET 4.6.2 framework must be installed on your Session Host RDAgent version 1.0.2944.400 or higher The WVDAgentUrlTool.exe file must be in the same folder as the WVDAgentUrlTool.config file # How to execute the tool First you need to open the Powershell and navigate to the RD Infrastructure Agent folder.\n1 cd C:\\Program Files\\Microsoft RDInfra\\RDAgent_1.0.2944.1200 Now you just need to execute the WVDAgentURLTool.exe and you’ll get the results after a few seconds presented.\n1 .\\WVDAgentUrlTool.exe As you can see from the results, some URLs from the list above are missing in the tool, therefore it’s mandatory to verify the mentioned required URLs before executing the tool.\n# Conclusion The WVD URL Check Tool is a great way of quickly checking the connectivity to the WVD services for your Session Hosts, but you have to keep in mind that you still have some prerequisites to fullfil before you can trust the result and ensure 100% connectivity to the service.\nIf you want to know more about the tool or have general questions about WVD connectivity feel free to reach out to me at any time!\nCheers,\nPatrick\n","date":"2021-04-20T16:56:47+06:00","image":"http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/title_hu47f31a060c17741ed671fdc891fc1e2a_68582_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/what-you-have-to-know-about-the-wvd-required-url-check-tool/","title":"What you have to know about the WVD Required URL check tool"},{"content":"Hi everyone,\nit’s been a while since my last blog post and I think it’s getting time for a very important topic for your end users – BROWSING!\nRegardless of which browser you’re using, we know that the correct configuration, paired with optimization and security is key to let users work smoothly.\nBut why do we need to optimize the browsing experience?\nI’m sure you know at least one of the types of users:\nAt least 15 tabs open because closing is too dangerous and pages need to be directly accessible From those 15 tabs, 3 are videos where specific playlists are running, even if the Tab itself is muted The virtual session starts to slow down over time All these mentioned topics depend on the right setup of your Browsing experience.\n# Overview – Microsoft Edge – Chromium Microsoft released the evolution of its classic Edge browser on 15. January 2020, so about one year ago. Since October 2020, the browser will be installed by default into the operating system by Windows Version 20H2. This version of Microsoft Edge is based on Chromium, an open-source project behind the Google Chrome Browser project.\nBut the Edge Chromium version isn’t just a copy of Google Chrome with a Microsoft branding – furthermore it includes additional functionalities and removes several interfaces to Google directly (which are obviously part of the Chromium project itself).\nSome of the advantages, why to choose the Edge Chromium Browser are:\nOwn Add-On store Microsoft Edge-Add-Ons (https://microsoftedge.microsoft.com/addons/Microsoft-Edge-Extensions-Home?hl=de) Advanced Privacy options, which can be configured using this link (edge://settings/privacy) Progressive Web Apps (literally converting Websites in to small apps which can be added to the Desktop or Startmenu – basically an advanced shortcut) # Edge Stable version 89 released Microsoft announced on 04.03.2021, that the new stable version 89 of Edge is being released. The official link can be found here: (https://blogs.windows.com/msedgedev/2021/03/04/edge-89-performance/)\nA summary of the key features can be found below:\nStartup boost functionality – improves app start time from 29% – 41% depending on your hardware resources Sleeping Tabs – Previously, Tabs that were opened in the background, still consumed hardware resources on the system. With resource heavy websites opened (such as video portals), the performance might suffer a lot! This has been tackled by Sleeping Tabs # Impact on Azure Virtual Desktop Especially those two new features, have a major impact on systems with shared hardware resources such as Windows 10 Enterprise Multi-Session. As browsing is an essential part of our work time and several applications transforming from classical Windows Apps to web applications, speed and intelligent resource consumptions are key to operate a virtual desktop environment.\n# Chapter 1 – Configure Sleeping Tabs To enable the sleeping tabs functionality, simply type the following path into the address bar of your Edge Chromium browser:\n1 edge://flags/#edge-sleeping-tabs You will be presented with the option to enable the setting, by clicking on “Default” on the right side and select “Enabled” from the drop-down list.\nAfterwards, Microsoft Edge requires you to perform a restart of the browser.\nNow, back in the browser, you can use the following path in the address bar to adjust your settings:\n1 edge://settings/?search=sleeping%20tabs The now visible options allow you to configure, when a tab will be set to “sleep”. By default this value is set to 2 hours of inactivity. I recommend you to change this value to really benefit of resource savings. I made good experiences, which the setting defined to 15 minutes. Simply click on the drop down of the value and select what fits for you the best.\nIf there are pages, you never want to go to sleep, you can select and define them below “add” underneath the point “Never put these sites to sleep”.\nType the URL or wildcard and click on add to enable your selection.\nWhen does this make sense? Especially, when you’re using CRMs or other database relying applications it might make sense to exclude them to avoid data loss in case that you forgot to return to a specific application.\n# Chapter 1-1 Enable Sleeping Tabs via Group Policy The more company related approach would be to enable Sleeping Tabs via Group Policies.\nYou can find the specific setting to define sleeping tabs here:\n1 Computer Configuration \u0026gt; Administrative Templates \u0026gt; Microsoft Edge Select Sleeping Tabs settings and set the policy to “Enabled“\n# Chapter 2 – How to enable startup boost To give your browser the required boost to startup, you can configure startup boost via the settings of your Edge browser:\n1 HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Edge Create a “DWORD” with the name “StartupBoostEnabled” and set it to “1”\n# Chapter 3 – Conclusion Microsoft have released a great way in Edge version 89 to optimize the browsing performance and experience in mutli-session environments. I can just highly encourage everyone to enable the above defined settings. I’m looking forward hearing your feedback about it!\n","date":"2021-03-08T16:56:47+06:00","image":"http://localhost:1313/p/microsoft-edge-the-complete-guide-for-avd/title_hu47f31a060c17741ed671fdc891fc1e2a_103632_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/microsoft-edge-the-complete-guide-for-avd/","title":"Microsoft Edge – The complete guide for AVD"},{"content":" First of all a very huge thanks to Christiaan Brinkhoff and Dean Cefola for having me at this awesome event, happened today, the 11.12.2020 in an XXL format! Microsoft Meets Community: Windows Virtual Desktop.\nIt was an absolute honour to speak for 2000 registered users from the community!\n# Chapter 1 – What is MSIX / App Attach? MSIX is a Windows app package format that provides a modern packaging experience for all Windows applications. Generally, MSIX preserves the functionalities of basic application packages and adds new functionalities for modern application delivery and installation to it. MSIX packages can be used everywhere in your Windows 10 based environments, which makes this format highly flexible for enterprise deployments.\nAn existing application installer can be used to convert Applications into MSIX packages and to expand them to be used in MSIX App Attach – Microsoft’s game-changing application delivery model!\n# Chapter 1.1 – How is a MSIX package built? A MSIX package consists usually of the following set of files:\nApplication Files: These are the files that represents the application/s itself and the dependencies inside of an MSIX package\nAppManifest: The App Manifest is an XML based document that contains information an OS needs for the deployment, display and update of an MSIX application. This info includes usually identity, package dependency information, required capabilities, visual elements of extensibility points.\nThe following example represents a screenshot from an opened AppManifest.xml: AppxBlockMap: The AppBlockMap is also represented as XML document, which contains a list of the app files along with indexes and cryptographic hashes for each block of data, which is stored inside of the package. The block map is secured by the digital signature used to sign the package itself.\nAppxSignature: To deploy and run apps, they need to be signed first. This can be through a CA (internal or external), or through a Self-Signed Certificate.\nApp Payload # Chapter 2 – MSIX App Attach MSIX App Attach is the new, modern app delivery model of Microsoft, which enables customers to easily deploy their packages MSIX packages in a container, like they’re probably using it already in form of an FSLogix Profile or Office365 container.\nThe functionality of MSIX App Attach is currently still in preview, but will be definitely one of the game changers in VDI environments, once GA!\nTo be able to deliver MSIX App Attach containers, the user must work on a Windows 10 2004 version or later, where the MSIX APIs are already built into the OS itself.\nYou might ask yourself – okay pretty fine, but what are the advantages of using this functionality?\nLess reimaging! Use standard images and capture/expand your applications for delivery via App Attach and store the containers in a central location within your network! Same package format across the organization. As you can centrally store the container it can be deployed throughout the complete organizational network. Updates can be applied immediately as needed. No repackaging needed – Some vendors already ship their apps as MSIX package Apps are indistinguishable from other apps on the OS. You can deploy different versions of one application with different dependencies without impacting the OS, other users, or other apps themselves (e.g. Chrome with certain security settings/extensions) # Chapter 2.1 – MSIX App Attach Terminology Now we need to cover, what are the stages we are using to start with MSIX App Attach and what do we exactly need to prepare. Here you can find a summary of tasks and wordings we use, while working with MSIX App Attach:\n# Chapter 2.1.1 – Expand This is the process where we take a MSIX package and unpack it (expand) it to a VHD container. It will be equipped with the software represented as an MSIX package and simply containerized.\nAfterward, we can store this VHD file on a global position within our network. For that make sure that your network share is SMB compatible and the VMs are able to read this location.\n# Chapter 2.1.2 – Stage The following steps are Powershell scripts, to be executed to make the magic happen! It all starts with the staging process, which is the moment when the VHD/X or CIM file gets mounted on the destination OS. Junctions will be created to stage the application. At this time, the user is not able to see the application yet.\nHere you can find an example staging script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 #MSIX app attach staging sample #region variables $ScriptParentPath = $MyInvocation.MyCommand.Path -replace $myInvocation.MyCommand.Name,\u0026#34;\u0026#34; $vhdSrc = (get-ChildItem -Path $ScriptParentPath -Filter *.vhd)[0].FullName Write-Host \u0026#34;VHD $vhdSrc found\u0026#34; $JSONFileName = \u0026#34;AppAttachInfo.json\u0026#34; $msixJunction = \u0026#34;$Env:Temp\\AppAttach\\\u0026#34; #endregion #region mountvhd try{ $VHDFolder = (Get-Item $vhdSrc).DirectoryName $JsonFile = \u0026#34;$VHDFolder\\$JSONFileName\u0026#34; If(Test-Path -Path $JsonFile){ $Json = get-content $JsonFile |ConvertFrom-Json $MountedVHD = Mount-DiskImage -ImagePath $vhdSrc -NoDriveLetter -Access ReadOnly $msixDest = $Json.PartitionPath $packageName = $Json.PackageName $parentFolder = $Json.ParentFolder $parentFolder = \u0026#34;\\\u0026#34; + $parentFolder + \u0026#34;\\\u0026#34; } else{ Write-Host \u0026#34;$JsonFile not found\u0026#34; } } catch { Write-Host (\u0026#34;Mounting of \u0026#34; + $vhdSrc + \u0026#34; has failed!\u0026#34;) -BackgroundColor Red } #endregion #region makelink if (!(Test-Path $msixJunction)){ md $msixJunction } $msixJunction = $msixJunction + $packageName cmd.exe /c mklink /j $msixJunction $msixDest #endregion #region stage [Windows.Management.Deployment.PackageManager,Windows.Management.Deployment,ContentType=WindowsRuntime]| Out-Null Add-Type -AssemblyName System.Runtime.WindowsRuntime $asTask = ([System.WindowsRuntimeSystemExtensions].GetMethods() | Where { $_.ToString() -eq \u0026#39;System.Threading.Tasks.Task`1[TResult] AsTask[TResult,TProgress](Windows.Foundation.IAsyncOperationWithProgress`2[TResult,TProgress])\u0026#39; })[0] $asTaskAsyncOperation = $asTask.MakeGenericMethod([Windows.Management.Deployment.DeploymentResult], [Windows.Management.Deployment.DeploymentProgress]) $packageManager = [Windows.Management.Deployment.PackageManager]::new() $path = $msixJunction + $parentFolder + $packageName # needed if we do the pbisigned.vhd $path = ([System.Uri]$path).AbsoluteUri $asyncOperation = $packageManager.StagePackageAsync(\u0026#34;$path\u0026#34;, $null, \u0026#34;StageInPlace\u0026#34;) $task = $asTaskAsyncOperation.Invoke($null, @($asyncOperation)) Do{ Start-Sleep -Milliseconds 100 }Until(($task.IsCompleted -eq $true) -or ($task.IsFaulted -eq $true)) $task.Exception $task.Status #endregion # Chapter 2.1.3 – Register From here, the mounted VHD/X or CIM file will be taken and the apps inside this container will be registered to the user’s session. More technically speaking, the MSIX file will be added to the C:\\Program Files\\WindowsApps\\ folder.\nHere is an example for the registering script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #MSIX app attach registration sample #region variables $ScriptParentPath = $MyInvocation.MyCommand.Path -replace $myInvocation.MyCommand.Name,\u0026#34;\u0026#34; $vhdSrc = (get-ChildItem -Path $ScriptParentPath -Filter *.vhd)[0].FullName Write-Host \u0026#34;VHD $vhdSrc found\u0026#34; $JSONFileName = \u0026#34;AppAttachInfo.json\u0026#34; $VHDFolder = (Get-Item $vhdSrc).DirectoryName $JsonFile = \u0026#34;$VHDFolder\\$JSONFileName\u0026#34; If(Test-Path -Path $JsonFile){ $Json = get-content $JsonFile |ConvertFrom-Json $packageName = $Json.PackageName } else{ Write-Host \u0026#34;$JsonFile not found\u0026#34; } #endregion #region register $path = \u0026#34;C:\\Program Files\\WindowsApps\\\u0026#34; + $packageName + \u0026#34;\\AppxManifest.xml\u0026#34; Add-AppxPackage -Path $path -DisableDevelopmentMode -Register #endregion # Chapter 2.1.4 – De-Register \u0026amp; De-Staging These are the steps where the made changes will be reverted from the system. The deregistration will happen and the junction will be deleted. Finally the container gets dismounted from the system.\nHere is an example for the de-registering script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #MSIX app attach deregistration sample #region variables $ScriptParentPath = $MyInvocation.MyCommand.Path -replace $myInvocation.MyCommand.Name,\u0026#34;\u0026#34; $vhdSrc = (get-ChildItem -Path $ScriptParentPath -Filter *.vhd)[0].FullName Write-Host \u0026#34;VHD $vhdSrc found\u0026#34; $JSONFileName = \u0026#34;AppAttachInfo.json\u0026#34; $VHDFolder = (Get-Item $vhdSrc).DirectoryName $JsonFile = \u0026#34;$VHDFolder\\$JSONFileName\u0026#34; If(Test-Path -Path $JsonFile){ $Json = get-content $JsonFile |ConvertFrom-Json $packageName = $Json.PackageName } else{ Write-Host \u0026#34;$JsonFile not found\u0026#34; } #endregion #region deregister Remove-AppxPackage -PreserveRoamableApplicationData $packageName #endregion And hereafter also an example of the de-staging script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 #MSIX app attach de staging sample #region variables $ScriptParentPath = $MyInvocation.MyCommand.Path -replace $myInvocation.MyCommand.Name,\u0026#34;\u0026#34; $vhdSrc = (get-ChildItem -Path $ScriptParentPath -Filter *.vhd)[0].FullName Write-Host \u0026#34;VHD $vhdSrc found\u0026#34; $JSONFileName = \u0026#34;AppAttachInfo.json\u0026#34; $VHDFolder = (Get-Item $vhdSrc).DirectoryName $JsonFile = \u0026#34;$VHDFolder\\$JSONFileName\u0026#34; $msixJunction = \u0026#34;$Env:Temp\\AppAttach\\\u0026#34; #endregion If(Test-Path -Path $JsonFile){ $Json = get-content $JsonFile |ConvertFrom-Json $packageName = $Json.PackageName $PackageMountPoint = \u0026#34;$msixJunction\\$packageName\u0026#34; } else{ Write-Host \u0026#34;$JsonFile not found\u0026#34; } #region deregister Remove-AppxPackage -AllUsers -Package $packageName #cd $msixJunction Remove-Item -Path $PackageMountPoint -Recurse -Force # rmdir $packageName -Force -Verbose Dismount-DiskImage -ImagePath $vhdSrc #endregion # Chapter 2.1.5 – The PowerShell scripts The following video shows you how to modify the PowerShell scripts needed to get started with MSIX App Attach. I assume at this stage, that you have a MSIX package ready or prepared earlier. I will go through all scripts starting from the Staging till the Destaging process.\n# Chapter 3 – Storage Options for MSIX App Attach The next question is of course, where to store the containers.\nIn my slides I’ve presented you with the three major possibilities that are given for Azure workloads:\nAzure Files (Premium Tier) / Azure NetApp Files / File Server VM on Azure\nThe advantages Azure Files provides, is that you can use the Active Directory built in security infrastructure, while using on-prem Security Groups to assign access to the file share. So you don’t need to adapt your environment heavily. Personally I recommend Azure Files for small to medium sized companies, which require less than 4TB storage.\nIf you require more storage, from 4 TB and beyond I recommend to go for Azure NetApp Files. A service which provides you with a bunch of features and the ultimate performance for larger environments.\nLast but not least you can also go for a classical VM on Azure, which acts as a File Server. Keep in mind, you are responsible for the security and maintenance of the machine!\n# Chapter 4 – Container Security Another huge topic is, how does MSIX packages and App Attach for a secure containerization and app delivery? The schema above represents the signing process of an MSIX package. As you have learned in the session – each MSIX package must be signed to be able to run on a Session Host.\nTo sign an app you can go for:\nAn internal / external CA Self-Signed Certificate The application certificate then must be imported to the destination device / OS to the Computer Certificate Store \u0026gt; Trusted People\nAnother security bringing capability is, that MSIX App Attach containers will be staged and mounted read-only on a Session Host. This means that an end user is not able to manipulate the application package. On the other hand it implicates that the packager takes care that no malicious software is inside of the package.\n# Chapter 5 – Which tools to use for MSIX App Attach? There are several tools you can use for the packaging, creation of the Powershell scripts etc.\nIf you need a tool for the packaging itself, you can use the official MSIX Packaging tool from the Microsoft Store: (https://www.microsoft.com/store/productId/9N5LW3JBCXKF)\nIf you want to know, how the tool works, I invite you to check out one of my latest blog posts which guides you through the installation and packaging of one application: Open Remote App from a started WVD session | WVDLOGIX – Windows Virtual Desktop and FSLogix Blog\nAnother great tool, which helps you then to automatically create the VHDX including the PowerShell scripts for App Attach is a free tool from Marcel Berger the MSIX Commander. It can be downloaded here: (https://github.com/bergerpascal/MSIX_Commander/releases).\n# Demo: Create an App Attach Container using MSIX Commander # Chapter 6 – Conclusion MSIX App Attach will be soon integrated in the Azure Portal, which will be an initiator for a lot of enterprises to test the new and modern app delivery method. This will remove the need of creating and maintaining the PowerShell scripts manually and will clearly streamline the delivery process even more. Additionally, with the CimFS based containers, applications can be even delivered more resource friendly on the Session Host, than with VHD or VHDX containers. I will constantly report about the latest MSIX news in my following blog posts.\nThanks a lot for attending to the event and if you have any question, feel free to reach out to me via Social Media or this blog page! Always happy to help you!\nCheers,\nPatrick!\n","date":"2020-12-11T16:56:47+06:00","image":"http://localhost:1313/p/container-up-your-applications-fast-secure-efficient-with-msix-app-attach/title_hu47f31a060c17741ed671fdc891fc1e2a_65534_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/container-up-your-applications-fast-secure-efficient-with-msix-app-attach/","title":"Container up your applications: fast, secure \u0026 efficient with MSIX App Attach"},{"content":"Last week I faced an issue at the client site while getting a Microsoft 365 Apps for Enterprise Activation notification after the user login.\nIn the menu bar in the center top we can see Word [Non-Commercial Use] [Unlicensed Product]\nOffice has worked for the last couple of months perfectly on WVD, so I had to investigate the issue and obviously, the first thing I’ve tried, is to Sign in again to see the application behavior. Finally, the screen was flickering a few times, but the error message persists and Office was simply unusable for all users on the system.\nSo first of all I started to analyze the base parameters like:\nFSLogix version used (it was 2.9.7349.30108 at the time of doc creation) Office version used (shown in the screenshot below) Office update channel in use (shown in the screenshot below) Roaming license token for Microsoft Apps in place I quickly realized that the client updated the image and changed the Update Channel from Semi-Annual channel to Current Channel.\nThis is in general not a big issue, but you need to make sure that Office is always in it’s latest version, which was not the case in this scenario!\n# Tip 1: If you need to choose Current Channel, make sure Office is in it’s latest version! But this didn’t solve the problem at all, it just brought us to the latest version. So the next thing to check is, what happened with our existing License Token for Microsoft Apps for Enterprise.\nUsually, when using FSLogix Profile and Office365 Container, we have the possibility and include the Office Activation Data inside the Office365 Container. This can be defined easily through Group Policies.\nIf thats the case for you, you’ll find the activation token as if you’re working with local profiles underneath the following location:\n%LOCALAPPDATA%\\Microsoft\\Office\\16.0 And it turned out that no files were present here! This was our starting point. Next, we need to ensure, that all user-related information is removed from the registry and that the Work or School Account settings are reset for the user to be able to renew the activation token.\nFor that reason, I’ve created a tool, which performs all of these tasks for you automatically and it can be used for one-shot remediation.\nPlease find the video and the tool download afterwards:\nThe tool is free usable and can be downloaded from my GitHub repository: (https://github.com/wvdlogix/M365TroubleshooterWVD)\nFinally, you can start one of your office apps again and you just need to click on accept license agreement, like it’s your first time starting office. Outlook data and configuration settings won’t be lost!\n","date":"2020-12-08T16:56:47+06:00","image":"http://localhost:1313/p/fslogix-and-microsoft-365-apps-for-enterprise-activation-issue-remediation/title_hu47f31a060c17741ed671fdc891fc1e2a_98805_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/fslogix-and-microsoft-365-apps-for-enterprise-activation-issue-remediation/","title":"FSLogix and Microsoft 365 Apps for Enterprise Activation issue remediation"},{"content":"Hi everybody it´s Patrick again with another blog post! It´s been busy weeks since my last article about Host Pool Automation (part 3), where I´ve shared with you my first Automation Scaling script, check it out if you´re interested how you can get started with automating your WVD session hosts to save costs!\nBut this week I´m going to start a new article series, focusing on increasing the User Experience in Windows Virtual Desktop for end-users as well as for admins!\nSince WVD Spring Release is available in public preview I was searching for the state of the art User Experience and finally I came to the conclusion that every environment has its own signature so that you can´t summarize and give the “final answer” to all usability questions, but at least we can try to optimize the environment, to make our end-users curious about what they can do in WVD, especially with the new Windows 10 Multi-Session 2004 version!\n# Chapter 1: Windows 10 Startmenu and Taskbar: The basics The Windows 10 startmenu or taskbar is the place in Windows to consolidate all installed applications on the system and to provide an easy to use navigation point while providing direct shortcuts to the applications without directly impacting the application installation.\nCustomizing the Windows 10 startmenu and taskbar is possible since the release of version 1607.\nBy default, a Windows 10 startmenu provides the following view, while opening it:\nWhile having a deeper look at the startmenu itself, we can separate it into the following areas:\nRecently Added: The place that displays, which applications have been installed recently Most used: A time-based consolidation, which presents a view of the most used applications on the system User tile: Shows the avatar of the user and allows to Change Account settings (for the logged-on user), Lock the system, Sign Out from the system Suggestions: Not necessary for enterprise usage. Most likely advertisement of Microsoft Store Apps. All Apps: Shows a list of all applications within the startmenu Power: Normally allows you to shut down, restart, sleep – but in Windows Virtual Desktop you only have the possibility to disconnect the session from the end-user perspective. Start layout: Can be separated into several groups, which include Tiles to start the applications. Tiles can be static (icon) or dynamic (animated). You can pin apps and folders to be started. %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\nIn here you can find the folders represented in your startmenu while viewing “All Apps”.\nTo review the location for default users in your environment and to review, where the default icons and application shortcuts are coming from, please find the location for the “all user startmenu”:\n%ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs. Finally the startmenu combines both locations and represents the results in the users startmenu.\nThe important startmenu rules\nTo get started with startmenu modifications you need to have in mind, that Microsoft has specific rules on how the whole background process around these startmenus are working, please find them here:\n# Indexiation! As you now know, the startmenu combines the both avalable locations from the user´s startmenu location in the profile with the one available for all users on the local C: drive.\nThere is a kind of indexiation process behind the scenes which identifies the existance of the same shortcut within the user´s profile and keeps only one version. This means: You cannot have two copies of the same EXE file in the startmenu!\n# The emptier the folder.. the less will be displayed.. If you´re managing application folders within your startmenu and you have no shortcuts within a specified folder, it wont be displayed!\n# The startmenu is NO PORSCHE! Very important to keep in mind is, when you do changes to the startmenu or folders, in most cases it requires some time to be applied. In some cases even a re-login to the system!\n# Troubleshooting! I remember my early days in IT, when my colleagues told me to check the event viewer for the exact error messages. If you see that there is an error related to the start menu or taskbar please find the appropriate log files here: Event Viewer \u0026gt; Applications and Services Log \u0026gt; Microsoft \u0026gt; Windows \u0026gt; ShellCommon-StartLayoutPopulation \u0026gt; Operational\n# Chapter 2: Configure the startmenu There are a lot of possibilities given to optimize the startmenu to your end-users needs! Beginning from the installation of new software over the deinstallation of Microsoft´s built-in applications (Appx) to the configuration of the visual setting and groupings of the startmenu. In this section you will learn to cleanup the startmenu and free it from consumer experiences and finally adapt it to your needs while respecting best practices and lessons learned from the past years.\n# Remove Consumer Experience Applications Removing the Consumer Experience Applications should always be the first start of optimizing Windows 10 to prevent, that our users are utilizing applications which aren´t supporting the productivity.\nIf you need to remove more application or just wanted to know, which AppX applications are installed by default, start a PowerShell as Administrator and type:\n1 Get-AppxPackage | ft Name Here is a list of applications, I usually remove from the golden image by default:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 Microsoft.XboxSpeechToTextOverlay Microsoft.OneConnect Microsoft.WindowsFeedbackHub Microsoft.windowscommunicationsapps Microsoft.BingWeather Microsoft.MicrosoftOfficeHub Microsoft.XboxIdentityProvider Microsoft.MicrosoftSolitaireCollection Microsoft.MicrosoftStickyNotes Microsoft.MSPaint Microsoft.People Microsoft.Print3D Microsoft.WindowsCamera Microsoft.Windows.Photos Microsoft.MixedReality.Portal Microsoft.Xbox.TCUI Microsoft.ScreenSketch Microsoft.Messaging Microsoft.SkypeApp Microsoft.XboxApp Microsoft.GetHelp Microsoft.ZuneMusic Microsoft.YourPhone Microsoft.WindowsAlarms Microsoft.WindowsCalculator Microsoft.ZuneVideo Microsoft.XboxGameOverlay Microsoft.XboxGamingOverlay Microsoft.WindowsMaps Microsoft.WindowsSoundRecorder Microsoft.Office.OneNote Microsoft.Getstarted Microsoft.Microsoft3Dviewer To simply remove these applications you can also just run the following Powershell Script in your Windows 10 environment:\n1 2 3 $appxpackage = \u0026#34;Microsoft.3DBuilder,Microsoft.Getstarted,Microsoft.MicrosoftOfficeHub,Microsoft.MicrosoftSolitaireCollection,Microsoft.People,Microsoft.SkypeApp,Microsoft.WindowsCommunicationsApps,Microsoft.XboxApp,Microsoft.ZuneMusic,Microsoft.ZuneVideo,Microsoft.BingFinance,Microsoft.BingNews,Microsoft.BingSports,Microsoft.BingWeather,Microsoft.Windows.Photos,Microsoft.WindowsCamera,Microsoft.WindowsMaps,Microsoft.YourPhone,Microsoft.WindowsSoundRecorder,Microsoft.WindowsAlarms,Microsoft.GetHelp, Microsoft.Microsoft3Dviewer,Microsoft.Messaging, Microsoft.MixedReality.Portal, Microsoft.WindowsFeedbackHub, Microsoft.Wallet, Microsoft.Print3D,\u0026#34; $appxpackage=$appxpackage.Split(\u0026#34;,\u0026#34;) foreach ($appx in $appxpackage) {Get-AppxPackage $appx -Allusers | Remove-AppxPackage} You will immediately identify, that the applications mentioned above are removed for all users of the system, meaning that future users in our WVD environment wont get those applications installed. But you might wonder, why we are able to see still some consumer applications in the StartMenu?\nThis is something related to the Windows 10 version you are using (in my example for testing purposes Win10 Pro), where you can disable the usage of consumer apps easily via GPO later on.\nThe required settings can be defined from the Group Policy Management console of your administrative computer (having the RSAT tools installed), or from any domain controller in your environment.\n# Pre-configure shortcuts for deployments Now it´s most likely the time for you to install your required applications. When this is done you can start creating the startmenu with the presets you want to give your endusers. You can do this in multiple ways:\nDrag\u0026amp;Drop the Shortcuts into the StartMenu Right-Click on a Shortcut “Pin to Start” Directly into an XML file for the very manual approach My tip: Do it with Drag\u0026amp;Drop and the Pinning method first!\nNow let´s start removing not required application shortcuts by performing a right-click on the tile and select: “Unpin folder from Start”.\nWe do this for all our applications and start adding the new tiles by searching them in the StartMenu, performing a right-click and selecting: “Pin to Start”.\nBy hovering over the name of the group, you can even modify it here:\nIn my example I specify the group name for my end users, that even the guy with less IT experience knows what these apps are about – hopefully 😉\nFinally the startmenu can look like this:\n%ScreenShot WVD Environment%\n# User Experience Tips! One thing that dramatically helps users to understand what they have to do when they finish their working day is to provide them with a dedicated Logoff button in the start menu. Like this the users, at least for my customers, are more willed to perform a clean logoff instead of just closing the session window or performing an unclean disconnect.\nTo create such a loggoff button, follow these steps:\nCreate a new batch file and enter the following line: shutdown -l -f -t 0 Save it in a location untouchable for your end users (in my case I´ve created C:\\Windows\\WVDSupport) Create a shortcut and paste it into the startmenu folder: C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Administrative Tools\\ When doing a right click on the shortcut you can change the icon, I´ve selected this one. Now reference it via Drag and Drop into the startmenu and export it and follow the steps descripted in chapter 4! # Chapter 3: Configure the Taskbar Since the version Windows 10 1607 you have the possibility to remove and pin additional applications to the Taskbar of Windows 10. In our case this is really helpful to pre-define the default settings for our end-users in the WVD environment.\nTo add new icons to the taskbar, simply drag and drop them from the start menu or perform a right-click \u0026gt; More \u0026gt; Pin to Taskbar\n# User Experience Tips! Don´t forget to pin the Windows Explorer / File Explorer! By default this is not the case but it will drastically improve the user experience.\nJust search for the Windows Explorer in your start menu and make a right-click \u0026gt; Pin to taskbar!\n# Chapter 4: Provisioning options for Windows Virtual Desktop For our deployment in WVD it´s really important to know the different ways of deploying the predefined settings to our end users. I will not be able to mention every single option in detail, but I will explain you most likely the pro´s and con´s of each approach and by interest I´m available to guide you through the setup in detail.\nLet me quickly present you, which characteristics a Startmenu or Taskbar can have for the end users and how we as administrators can benefit from some settings:\nMandatory startmenu: A predefined layout that end-users are NOT able to change in any way. It´s completely configured by the administrator and there is no way of removing Tiles or adding new ones Pro´s: Easy administrative effort, as Admins have the full control over what is presented to the end-users Con´s: The users will heavily complain in some cases, because the IT department doesn´t integrate their daily business application Partially Customizable startmenu: This allows the administrator to predefine the startlayout and set specific groups to a mandatory state. This means, that certain groups are not modifiable, while other areas can be modified by the end-users. Pro´s: Mandatory applications are always pinned to the startmenu, this allows easy access to mandatory applications everyone needs. Additionally the user can modify and add his / her favorite tools on top of that. Con´s: Administrative effort can be a bit higher, when troubleshooting user interaction mistakes Default Start Menu: Enables the predefined settings by the administrators and allows the user to fully optimize and adopt the startmenu Pro´s: Allows the IT department to completely pre-define the startmenu and give the user the full flexibility afterwards Con´s: Need to be implemented in the Golden Image by either importing the Layout via PowerShell or by copying the LayoutModification.xml into the Default User Profile (Explained later) Let me present you quickly how to setup every of these three possibilities:\n# Configure the mandatory startmenu The first thing, after defining the startmenu is to export it. To do so you must start the Powershell as an administrator and run the following command:\n1 Export-StartLayout -Path %UNC Path to your location%\\filename.xml The result will be exported as an XML and should look like this:\nAs you can see, the XML is structured based on the shortcuts you defined in your startmenu layout.\nI highly recommend you to have a look at the official Microsoft documentation for more information about, how this XML file is built: (https://docs.microsoft.com/en-us/windows/configuration/start-layout-xml-desktop)\nTo make this startlayout finally mandatory, we need to define the XML as StartLayout via Group Policy. To do so, open up the Group Policy Management Console and create a new GPO or edit an existing one:\nUser Configuration \u0026gt; Administrative Templates \u0026gt; Start Menu and Taskbar \u0026gt; Start Layout Once applied the startlayout will be enforced for all users, where it applies!\n# Configure the partially customizable startmenu To define a partially customizable startmenu we need to go back to the point, where we have exported our startmenu. As a small reminder, you have to open the PowerShell as Administrator and run:\n1 Export-StartLayout -Path %UNC Path to your location%\\filename.xml Now you need to open this XML file and define the groups, you want to lock or prevent the user from changing it.\nYou will see the start of the seciton “DefaultLayoutOverride” in this XML, which needs to be adapted for the usage of partial customizable menus.\nTo enable that feature just replace this value by: Now, all definitions you did in this XML file will become active, once you reimport that file on your golden image or user session.\nThis can be done by re-importing it via Powershell using this command as Administrator:\nImport-StartLayout -LayoutPath \\%UNCToStartLayout%\\StartLayout.xml -MountPath c:\nOr by renaming your XML into LayoutModification.xml and place it into the Default user Shell folder:\n“C:\\Users\\Default\\AppData\\Local\\Microsoft\\Windows\\Shell\\LayoutModification.xml”\nThis will activate the settings for all users, that will be created on that system.\n# Configure a Default Start Menu The last option is to simply export the startmenu as mentioned above and place it into the Shell folder without any modification on the XML file itself! Please keep in mind that the XML must be named “LayoutModification.xml”, otherwise your process of enabling the default layout will fail!\n# Chapter 5: Download the resources If you want to get my start layout, please find it here to be used for your deployments! Via the tasks descripted in chapter 4 you can adapt it to your individual needs. Please keep in mind that my startlayout requires to work the updated Edge Browser and the installed Office365 ProPlus package.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 \u0026lt;LayoutModificationTemplate xmlns:defaultlayout=\u0026#34;http://schemas.microsoft.com/Start/2014/FullDefaultLayout\u0026#34; xmlns:start=\u0026#34;http://schemas.microsoft.com/Start/2014/StartLayout\u0026#34; Version=\u0026#34;1\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/Start/2014/LayoutModification\u0026#34;\u0026gt; \u0026lt;LayoutOptions StartTileGroupCellWidth=\u0026#34;6\u0026#34; /\u0026gt; \u0026lt;DefaultLayoutOverride\u0026gt; \u0026lt;StartLayoutCollection\u0026gt; \u0026lt;defaultlayout:StartLayout GroupCellWidth=\u0026#34;6\u0026#34;\u0026gt; \u0026lt;start:Group Name=\u0026#34;Browsers\u0026#34;\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;4\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Internet Explorer.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;0\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Microsoft Edge.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;2\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Google Chrome.lnk\u0026#34; /\u0026gt; \u0026lt;/start:Group\u0026gt; \u0026lt;start:Group Name=\u0026#34;Utilities\u0026#34;\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;2\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\System Tools\\File Explorer.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;1x1\u0026#34; Column=\u0026#34;4\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Snipping Tool.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;1x1\u0026#34; Column=\u0026#34;4\u0026#34; Row=\u0026#34;1\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Quick Assist.lnk\u0026#34; /\u0026gt; \u0026lt;start:Tile Size=\u0026#34;1x1\u0026#34; Column=\u0026#34;5\u0026#34; Row=\u0026#34;0\u0026#34; AppUserModelID=\u0026#34;Microsoft.PPIProjection_cw5n1h2txyewy!Microsoft.PPIProjection\u0026#34; /\u0026gt; \u0026lt;start:Tile Size=\u0026#34;1x1\u0026#34; Column=\u0026#34;5\u0026#34; Row=\u0026#34;1\u0026#34; AppUserModelID=\u0026#34;windows.immersivecontrolpanel_cw5n1h2txyewy!microsoft.windows.immersivecontrolpanel\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;0\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Administrative Tools\\GaaschTools\\Logoff.lnk\u0026#34; /\u0026gt; \u0026lt;/start:Group\u0026gt; \u0026lt;start:Group Name=\u0026#34;Microsoft 365 ProPlus\u0026#34;\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;2\u0026#34; Row=\u0026#34;2\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\PowerPoint.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;0\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Outlook.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;4\u0026#34; Row=\u0026#34;2\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Publisher.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;2\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Word.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;4\u0026#34; Row=\u0026#34;0\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Excel.lnk\u0026#34; /\u0026gt; \u0026lt;start:DesktopApplicationTile Size=\u0026#34;2x2\u0026#34; Column=\u0026#34;0\u0026#34; Row=\u0026#34;2\u0026#34; DesktopApplicationLinkPath=\u0026#34;%ALLUSERSPROFILE%\\Microsoft\\Windows\\Start Menu\\Programs\\Access.lnk\u0026#34; /\u0026gt; \u0026lt;/start:Group\u0026gt; \u0026lt;/defaultlayout:StartLayout\u0026gt; \u0026lt;/StartLayoutCollection\u0026gt; \u0026lt;/DefaultLayoutOverride\u0026gt; \u0026lt;/LayoutModificationTemplate\u0026gt; I hope you like this article and if you have any kind of questions, ping me on Twitter, LinkedIn or down in the comments!\nHave a great weekend everyone! Cheers,\nPatrick\n","date":"2020-07-02T16:56:47+06:00","image":"http://localhost:1313/p/azure-virtual-desktop-windows-10-start-menu-optimization-guide/title_hu47f31a060c17741ed671fdc891fc1e2a_227218_120x120_fill_box_smart1_3.png","permalink":"http://localhost:1313/p/azure-virtual-desktop-windows-10-start-menu-optimization-guide/","title":"Azure Virtual Desktop - Windows 10 Start menu optimization guide"}]